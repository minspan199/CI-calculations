clc
clear all
% close all

% Htop = 3*Ht
Data = [9.60000000000000e-08 + 0.00000000000000i,0.0254548298925831 + 0.146991979861404i;9.70000000000000e-08 + 0.00000000000000i,0.116116577300182 + 0.0319499457369640i;9.80000000000000e-08 + 0.00000000000000i,0.213766024430599 + 0.0172066374110235i;9.90000000000000e-08 + 0.00000000000000i,0.279342417700025 + 0.0130535443531821i;1.00000000000000e-07 + 0.00000000000000i,0.331622361949553 + 0.0108993440187655i;1.01000000000000e-07 + 0.00000000000000i,0.376152221549651 + 0.00952411371917482i;1.02000000000000e-07 + 0.00000000000000i,0.415418605050297 + 0.00854653816757532i;1.03000000000000e-07 + 0.00000000000000i,0.450805742330710 + 0.00780397702196854i;1.04000000000000e-07 + 0.00000000000000i,0.483171791670746 + 0.00721377151859072i;1.05000000000000e-07 + 0.00000000000000i,0.513098579165417 + 0.00672887955550661i;1.06000000000000e-07 + 0.00000000000000i,0.541004451539578 + 0.00632060290777395i;1.07000000000000e-07 + 0.00000000000000i,0.567180287574112 + 0.00596954357649351i;1.08000000000000e-07 + 0.00000000000000i,0.591877791969627 + 0.00566297531204938i;1.09000000000000e-07 + 0.00000000000000i,0.615273250787255 + 0.00539141167754060i;1.10000000000000e-07 + 0.00000000000000i,0.637517602203006 + 0.00514801485157729i;1.11000000000000e-07 + 0.00000000000000i,0.658737632278635 + 0.00492773155442319i;1.12000000000000e-07 + 0.00000000000000i,0.679029713288757 + 0.00472637532438432i;1.13000000000000e-07 + 0.00000000000000i,0.698483021784230 + 0.00454086418637606i;1.14000000000000e-07 + 0.00000000000000i,0.717164715291211 + 0.00436852021688301i;1.15000000000000e-07 + 0.00000000000000i,0.735146611808856 + 0.00420740776003304i;1.16000000000000e-07 + 0.00000000000000i,0.752482974233516 + 0.00405579310113868i;1.17000000000000e-07 + 0.00000000000000i,0.769213632194589 + 0.00391203409541636i;1.18000000000000e-07 + 0.00000000000000i,0.785388940984885 + 0.00377506578110100i;1.19000000000000e-07 + 0.00000000000000i,0.801045434742204 + 0.00364375036172258i;1.20000000000000e-07 + 0.00000000000000i,0.816215721308737 + 0.00351720836660163i;1.21000000000000e-07 + 0.00000000000000i,0.830933061050107 + 0.00339470812043840i;1.22000000000000e-07 + 0.00000000000000i,0.845222245100477 + 0.00327556044122986i;1.23000000000000e-07 + 0.00000000000000i,0.859108852625787 + 0.00315924665695290i;1.24000000000000e-07 + 0.00000000000000i,0.872610663560891 + 0.00304539580335395i;1.25000000000000e-07 + 0.00000000000000i,0.885758863892686 + 0.00293390050109868i;1.26000000000000e-07 + 0.00000000000000i,0.898569823445231 + 0.00282475363203990i;1.27000000000000e-07 + 0.00000000000000i,0.911056808369039 + 0.00271805312063739i;1.28000000000000e-07 + 0.00000000000000i,0.923243250674726 + 0.00261440760453315i;1.29000000000000e-07 + 0.00000000000000i,0.935138940973392 + 0.00251440262652249i;1.30000000000000e-07 + 0.00000000000000i,0.946756989177352 + 0.00241898633307739i;1.31000000000000e-07 + 0.00000000000000i,0.958115574466689 + 0.00232945483038153i;1.32000000000000e-07 + 0.00000000000000i,0.969224495772672 + 0.00224708926710162i;1.33000000000000e-07 + 0.00000000000000i,0.980089397985963 + 0.00217306595729649i;1.34000000000000e-07 + 0.00000000000000i,0.990723266233493 + 0.00210865891911016i;1.35000000000000e-07 + 0.00000000000000i,1.00113423710263 + 0.00205469704924592i;1.36000000000000e-07 + 0.00000000000000i,1.01132716107489 + 0.00201141791812264i;1.37000000000000e-07 + 0.00000000000000i,1.02131184141384 + 0.00197875018263166i;1.38000000000000e-07 + 0.00000000000000i,1.03108812633869 + 0.00195575983311289i;1.39000000000000e-07 + 0.00000000000000i,1.04066857385733 + 0.00194136977338075i;1.40000000000000e-07 + 0.00000000000000i,1.05005585016443 + 0.00193401829798498i;1.41000000000000e-07 + 0.00000000000000i,1.05925936747518 + 0.00193219285702880i;1.42000000000000e-07 + 0.00000000000000i,1.06827648474929 + 0.00193405792756778i;1.43000000000000e-07 + 0.00000000000000i,1.07712726567630 + 0.00193857819697333i;1.44000000000000e-07 + 0.00000000000000i,1.08579857741332 + 0.00194407899927391i;1.45000000000000e-07 + 0.00000000000000i,1.09431675741599 + 0.00195014111856817i;1.46000000000000e-07 + 0.00000000000000i,1.10267713735232 + 0.00195573739581406i;1.47000000000000e-07 + 0.00000000000000i,1.11088586589637 + 0.00196044575860264i;1.48000000000000e-07 + 0.00000000000000i,1.11895187883597 + 0.00196407270133081i;1.49000000000000e-07 + 0.00000000000000i,1.12687696473888 + 0.00196631681214035i;1.50000000000000e-07 + 0.00000000000000i,1.13466583062043 + 0.00196712861320547i;1.51000000000000e-07 + 0.00000000000000i,1.14232404255464 + 0.00196653528207924i;1.52000000000000e-07 + 0.00000000000000i,1.14985430330135 + 0.00196457739796114i;1.53000000000000e-07 + 0.00000000000000i,1.15726418697644 + 0.00196140342602474i;1.54000000000000e-07 + 0.00000000000000i,1.16455176943761 + 0.00195698059512558i;1.55000000000000e-07 + 0.00000000000000i,1.17172479525727 + 0.00195153325530127i;1.56000000000000e-07 + 0.00000000000000i,1.17878688109796 + 0.00194518423377240i;1.57000000000000e-07 + 0.00000000000000i,1.18573868737449 + 0.00193796107455579i;1.58000000000000e-07 + 0.00000000000000i,1.19258594694858 + 0.00193006398750156i;1.59000000000000e-07 + 0.00000000000000i,1.19933023574249 + 0.00192154729025209i;1.60000000000000e-07 + 0.00000000000000i,1.20597060852398 + 0.00191237047958737i;1.61000000000000e-07 + 0.00000000000000i,1.21251740533653 + 0.00190285975393996i;1.62000000000000e-07 + 0.00000000000000i,1.21896846635596 + 0.00189294918106115i;1.63000000000000e-07 + 0.00000000000000i,1.22532708018736 + 0.00188272761749836i;1.64000000000000e-07 + 0.00000000000000i,1.23158853805041 + 0.00187219562409132i;1.65000000000000e-07 + 0.00000000000000i,1.23776714048949 + 0.00186148001416283i;1.66000000000000e-07 + 0.00000000000000i,1.24386144054101 + 0.00185066758129385i;1.67000000000000e-07 + 0.00000000000000i,1.24987169158541 + 0.00183973504573047i;1.68000000000000e-07 + 0.00000000000000i,1.25580068799966 + 0.00182872921504707i;1.69000000000000e-07 + 0.00000000000000i,1.26165174996662 + 0.00181774773100865i;1.70000000000000e-07 + 0.00000000000000i,1.26742289593631 + 0.00180670184754444i;1.71000000000000e-07 + 0.00000000000000i,1.27311901566408 + 0.00179569968360094i;1.72000000000000e-07 + 0.00000000000000i,1.27874103518117 + 0.00178474120858403i;1.73000000000000e-07 + 0.00000000000000i,1.28428983563591 + 0.00177381929716927i;1.74000000000000e-07 + 0.00000000000000i,1.28976908899047 + 0.00176299980214877i;1.75000000000000e-07 + 0.00000000000000i,1.29517967793987 + 0.00175229518107341i;1.76000000000000e-07 + 0.00000000000000i,1.30051882248155 + 0.00174157258067053i;1.77000000000000e-07 + 0.00000000000000i,1.30579650585417 + 0.00173112527879920i;1.78000000000000e-07 + 0.00000000000000i,1.31100572084452 + 0.00172069723631807i;1.79000000000000e-07 + 0.00000000000000i,1.31615307429922 + 0.00171042211788107i;1.80000000000000e-07 + 0.00000000000000i,1.32123765112224 + 0.00170029398935891i;1.81000000000000e-07 + 0.00000000000000i,1.32626201707324 + 0.00169031036744505i;1.82000000000000e-07 + 0.00000000000000i,1.33122665107215 + 0.00168045961265984i;1.83000000000000e-07 + 0.00000000000000i,1.33613326484277 + 0.00167079194895613i;1.84000000000000e-07 + 0.00000000000000i,1.34098269854689 + 0.00166127023757659i;1.85000000000000e-07 + 0.00000000000000i,1.34576837255446 + 0.00165180534917468i;1.86000000000000e-07 + 0.00000000000000i,1.35050999232592 + 0.00164267699684182i;1.87000000000000e-07 + 0.00000000000000i,1.35519298957239 + 0.00163358712468411i;1.88000000000000e-07 + 0.00000000000000i,1.35982766876277 + 0.00162477106314468i;1.89000000000000e-07 + 0.00000000000000i,1.36440732385501 + 0.00161603644062969i;1.90000000000000e-07 + 0.00000000000000i,1.36893827254881 + 0.00160751304978437i;1.91000000000000e-07 + 0.00000000000000i,1.37341838569388 + 0.00159911790511519i;1.92000000000000e-07 + 0.00000000000000i,1.37785064662618 + 0.00159092373491182i;1.93000000000000e-07 + 0.00000000000000i,1.38223581438614 + 0.00158289194378794i;1.94000000000000e-07 + 0.00000000000000i,1.38657292359572 + 0.00157500678785232i;1.95000000000000e-07 + 0.00000000000000i,1.39086513478958 + 0.00156731180972488i;1.96000000000000e-07 + 0.00000000000000i,1.39511129930024 + 0.00155974677419545i;1.97000000000000e-07 + 0.00000000000000i,1.39931535940177 + 0.00155241149959553i;1.98000000000000e-07 + 0.00000000000000i,1.40347284744909 + 0.00154516131115078i;1.99000000000000e-07 + 0.00000000000000i,1.40758968828081 + 0.00153810943579387i;2.00000000000000e-07 + 0.00000000000000i,1.41166348649878 + 0.00153118901270652i;2.01000000000000e-07 + 0.00000000000000i,1.41569698391325 + 0.00152445323584152i;2.02000000000000e-07 + 0.00000000000000i,1.41969040280927 + 0.00151788708878906i;2.03000000000000e-07 + 0.00000000000000i,1.42364276776044 + 0.00151142838317588i;2.04000000000000e-07 + 0.00000000000000i,1.42755174785013 + 0.00150512107116431i;2.05000000000000e-07 + 0.00000000000000i,1.43142698602093 + 0.00149898357184612i;2.06000000000000e-07 + 0.00000000000000i,1.43526444475147 + 0.00149299299228637i;2.07000000000000e-07 + 0.00000000000000i,1.43906545722107 + 0.00148716034776487i;2.08000000000000e-07 + 0.00000000000000i,1.44282974285268 + 0.00148147471920785i;2.09000000000000e-07 + 0.00000000000000i,1.44655975929756 + 0.00147597021000472i;2.10000000000000e-07 + 0.00000000000000i,1.45025235119970 + 0.00147053518574203i;2.11000000000000e-07 + 0.00000000000000i,1.45391094580360 + 0.00146528282082922i;2.12000000000000e-07 + 0.00000000000000i,1.45753596498336 + 0.00146016350123518i;2.13000000000000e-07 + 0.00000000000000i,1.46112670822726 + 0.00145516271041135i;2.14000000000000e-07 + 0.00000000000000i,1.46468602788166 + 0.00145033923504088i;2.15000000000000e-07 + 0.00000000000000i,1.46821153076425 + 0.00144561090178486i;2.16000000000000e-07 + 0.00000000000000i,1.47170549077020 + 0.00144103130208365i;2.17000000000000e-07 + 0.00000000000000i,1.47516858878553 + 0.00143658700724289i;2.18000000000000e-07 + 0.00000000000000i,1.47860044180382 + 0.00143227150823817i;2.19000000000000e-07 + 0.00000000000000i,1.48200220105660 + 0.00142808246589545i;2.20000000000000e-07 + 0.00000000000000i,1.48537442202602 + 0.00142404211284314i;2.21000000000000e-07 + 0.00000000000000i,1.48871713787672 + 0.00142009654327672i;2.22000000000000e-07 + 0.00000000000000i,1.49203036735262 + 0.00141628320767353i;2.23000000000000e-07 + 0.00000000000000i,1.49531528967022 + 0.00141258874363724i;2.24000000000000e-07 + 0.00000000000000i,1.49857159998706 + 0.00140899825361207i;2.25000000000000e-07 + 0.00000000000000i,1.50179438080852 + 0.00140549060198654i;2.26000000000000e-07 + 0.00000000000000i,1.50499421293002 + 0.00140209724770488i;2.27000000000000e-07 + 0.00000000000000i,1.50817063790917 + 0.00139891464644648i;2.28000000000000e-07 + 0.00000000000000i,1.51131893308875 + 0.00139579610063747i;2.29000000000000e-07 + 0.00000000000000i,1.51444104706518 + 0.00139278100117302i;2.30000000000000e-07 + 0.00000000000000i,1.51753676373235 + 0.00138986416689653i;2.31000000000000e-07 + 0.00000000000000i,1.52060873025692 + 0.00138708761863175i;2.32000000000000e-07 + 0.00000000000000i,1.52365500263886 + 0.00138440363974171i;2.33000000000000e-07 + 0.00000000000000i,1.52667612226123 + 0.00138181218306753i;2.34000000000000e-07 + 0.00000000000000i,1.52967455692375 + 0.00137936085502107i;2.35000000000000e-07 + 0.00000000000000i,1.53264723499309 + 0.00137696512973461i;2.36000000000000e-07 + 0.00000000000000i,1.53559720536088 + 0.00137469200454598i;2.37000000000000e-07 + 0.00000000000000i,1.53852437688163 + 0.00137252515793138i;2.38000000000000e-07 + 0.00000000000000i,1.54142710413394 + 0.00137042294019098i;2.39000000000000e-07 + 0.00000000000000i,1.54430970233359 + 0.00136847711597078i;2.40000000000000e-07 + 0.00000000000000i,1.54716817842614 + 0.00136657353407861i;2.41000000000000e-07 + 0.00000000000000i,1.55000562418966 + 0.00136478737376272i;2.42000000000000e-07 + 0.00000000000000i,1.55282186776947 + 0.00136310758206613i;2.43000000000000e-07 + 0.00000000000000i,1.55561495548431 + 0.00136147420584161i;2.44000000000000e-07 + 0.00000000000000i,1.55838146892919 + 0.00135989854764224i;2.45000000000000e-07 + 0.00000000000000i,1.56113409206088 + 0.00135848867054147i;2.46000000000000e-07 + 0.00000000000000i,1.56386549650404 + 0.00135712886233580i;2.47000000000000e-07 + 0.00000000000000i,1.56657771625394 + 0.00135589068608662i;2.48000000000000e-07 + 0.00000000000000i,1.56926869227269 + 0.00135471017414392i;2.49000000000000e-07 + 0.00000000000000i,1.57194049015653 + 0.00135362566375569i;2.50000000000000e-07 + 0.00000000000000i,1.57459151825734 + 0.00135258238408230i;2.51000000000000e-07 + 0.00000000000000i,1.57722369565529 + 0.00135164658967903i;2.52000000000000e-07 + 0.00000000000000i,1.57983875057837 + 0.00135082451059559i;2.53000000000000e-07 + 0.00000000000000i,1.58243433470722 + 0.00135006512383510i;2.54000000000000e-07 + 0.00000000000000i,1.58501192604502 + 0.00134938947846439i;2.55000000000000e-07 + 0.00000000000000i,1.58756991160368 + 0.00134876335573713i;2.56000000000000e-07 + 0.00000000000000i,1.59011055892566 + 0.00134822623960858i;2.57000000000000e-07 + 0.00000000000000i,1.59263295864278 + 0.00134775928578868i;2.58000000000000e-07 + 0.00000000000000i,1.59513983682365 + 0.00134740532535750i;2.59000000000000e-07 + 0.00000000000000i,1.59762621010801 + 0.00134705727384953i;2.60000000000000e-07 + 0.00000000000000i,1.60009720066014 + 0.00134681736656615i;2.61000000000000e-07 + 0.00000000000000i,1.60255210564229 + 0.00134666525346044i;2.62000000000000e-07 + 0.00000000000000i,1.60498942306753 + 0.00134656515437449i;2.63000000000000e-07 + 0.00000000000000i,1.60741084347301 + 0.00134654585748957i;2.64000000000000e-07 + 0.00000000000000i,1.60981239993170 + 0.00134651715983385i;2.65000000000000e-07 + 0.00000000000000i,1.61219727703335 + 0.00134661660971897i;2.66000000000000e-07 + 0.00000000000000i,1.61456953015596 + 0.00134677758264714i;2.67000000000000e-07 + 0.00000000000000i,1.61692598888747 + 0.00134700180179747i;2.68000000000000e-07 + 0.00000000000000i,1.61926861942718 + 0.00134733316376405i;2.69000000000000e-07 + 0.00000000000000i,1.62159309154392 + 0.00134766198569961i;2.70000000000000e-07 + 0.00000000000000i,1.62390353142132 + 0.00134807388888252i;2.71000000000000e-07 + 0.00000000000000i,1.62619876445993 + 0.00134854490346743i;2.72000000000000e-07 + 0.00000000000000i,1.62847966560156 + 0.00134908082352492i;2.73000000000000e-07 + 0.00000000000000i,1.63074569982033 + 0.00134967944048694i;2.74000000000000e-07 + 0.00000000000000i,1.63299719324770 + 0.00135033087388813i;2.75000000000000e-07 + 0.00000000000000i,1.63523571120368 + 0.00135107473930552i;2.76000000000000e-07 + 0.00000000000000i,1.63745808015163 + 0.00135182109949582i;2.77000000000000e-07 + 0.00000000000000i,1.63966686015791 + 0.00135264632984086i;2.78000000000000e-07 + 0.00000000000000i,1.64186179042829 + 0.00135351940997010i;2.79000000000000e-07 + 0.00000000000000i,1.64404364251419 + 0.00135445450781593i;2.80000000000000e-07 + 0.00000000000000i,1.64621206214214 + 0.00135544972342571i;2.81000000000000e-07 + 0.00000000000000i,1.64836795316414 + 0.00135650926470088i;2.82000000000000e-07 + 0.00000000000000i,1.65050942926434 + 0.00135760798634960i;2.83000000000000e-07 + 0.00000000000000i,1.65263673724539 + 0.00135872425802722i;2.84000000000000e-07 + 0.00000000000000i,1.65474865838112 + 0.00135991312648640i;2.85000000000000e-07 + 0.00000000000000i,1.65685072134575 + 0.00136115520318632i;2.86000000000000e-07 + 0.00000000000000i,1.65894049966394 + 0.00136243576068621i;2.87000000000000e-07 + 0.00000000000000i,1.66101797400486 + 0.00136377963069693i;2.88000000000000e-07 + 0.00000000000000i,1.66308339316467 + 0.00136517791169436i;2.89000000000000e-07 + 0.00000000000000i,1.66513651881309 + 0.00136662023042348i;2.90000000000000e-07 + 0.00000000000000i,1.66717774121520 + 0.00136811666291325i;2.91000000000000e-07 + 0.00000000000000i,1.66920598824802 + 0.00136963213587257i;2.92000000000000e-07 + 0.00000000000000i,1.67122327828480 + 0.00137122012884947i;2.93000000000000e-07 + 0.00000000000000i,1.67322889459440 + 0.00137283848661653i;2.94000000000000e-07 + 0.00000000000000i,1.67522172092901 + 0.00137448915904638i;2.95000000000000e-07 + 0.00000000000000i,1.67720430602321 + 0.00137620968336602i;2.96000000000000e-07 + 0.00000000000000i,1.67917482342281 + 0.00137794775549594i;2.97000000000000e-07 + 0.00000000000000i,1.68113447842986 + 0.00137975144096113i;2.98000000000000e-07 + 0.00000000000000i,1.68308310213258 + 0.00138158742144026i;2.99000000000000e-07 + 0.00000000000000i,1.68502072190255 + 0.00138346801953219i;3.00000000000000e-07 + 0.00000000000000i,1.68694677501247 + 0.00138537525443643i;3.01000000000000e-07 + 0.00000000000000i,1.68886220932149 + 0.00138732406754904i;3.02000000000000e-07 + 0.00000000000000i,1.69076831931251 + 0.00138933321280840i;3.03000000000000e-07 + 0.00000000000000i,1.69266275550723 + 0.00139137428917206i;3.04000000000000e-07 + 0.00000000000000i,1.69454674799408 + 0.00139345180771020i;3.05000000000000e-07 + 0.00000000000000i,1.69641629853469 + 0.00139553969593289i;3.06000000000000e-07 + 0.00000000000000i,1.69828014592725 + 0.00139769276741303i;3.07000000000000e-07 + 0.00000000000000i,1.70013273621384 + 0.00139986612355685i;3.08000000000000e-07 + 0.00000000000000i,1.70197612910181 + 0.00140208407876811i;3.09000000000000e-07 + 0.00000000000000i,1.70380883448325 + 0.00140432996369707i;3.10000000000000e-07 + 0.00000000000000i,1.70563350812666 + 0.00140664837053787i;3.11000000000000e-07 + 0.00000000000000i,1.70744663980164 + 0.00140896112342942i;3.12000000000000e-07 + 0.00000000000000i,1.70925048776736 + 0.00141132547257467i;3.13000000000000e-07 + 0.00000000000000i,1.71104474965689 + 0.00141371794804312i;3.14000000000000e-07 + 0.00000000000000i,1.71283031539298 + 0.00141614885580394i;3.15000000000000e-07 + 0.00000000000000i,1.71460521490596 + 0.00141859452449071i;3.16000000000000e-07 + 0.00000000000000i,1.71637211152235 + 0.00142110290415765i;3.17000000000000e-07 + 0.00000000000000i,1.71812994818023 + 0.00142364725000120i;3.18000000000000e-07 + 0.00000000000000i,1.71987669263360 + 0.00142617102010516i;3.19000000000000e-07 + 0.00000000000000i,1.72161600913788 + 0.00142877484966322i;3.20000000000000e-07 + 0.00000000000000i,1.72334675452988 + 0.00143140997058683i;3.21000000000000e-07 + 0.00000000000000i,1.72506749867457 + 0.00143405129486962i;3.22000000000000e-07 + 0.00000000000000i,1.72678133600820 + 0.00143675249916755i;3.23000000000000e-07 + 0.00000000000000i,1.72848490869866 + 0.00143945890219456i;3.24000000000000e-07 + 0.00000000000000i,1.73018065407739 + 0.00144221339796495i;3.25000000000000e-07 + 0.00000000000000i,1.73186295166356 + 0.00144495927913404i;3.26000000000000e-07 + 0.00000000000000i,1.73354072607147 + 0.00144775167746883i;3.27000000000000e-07 + 0.00000000000000i,1.73521132243807 + 0.00145059224514884i;3.28000000000000e-07 + 0.00000000000000i,1.73687369859926 + 0.00145346018394626i;3.29000000000000e-07 + 0.00000000000000i,1.73852715117639 + 0.00145634704824764i;3.30000000000000e-07 + 0.00000000000000i,1.74017260890900 + 0.00145925389755250i;3.31000000000000e-07 + 0.00000000000000i,1.74180934193209 + 0.00146218708359737i;3.32000000000000e-07 + 0.00000000000000i,1.74343927716497 + 0.00146516338035308i;3.33000000000000e-07 + 0.00000000000000i,1.74506195797401 + 0.00146818083641867i;3.34000000000000e-07 + 0.00000000000000i,1.74667497209583 + 0.00147118687558529i;3.35000000000000e-07 + 0.00000000000000i,1.74828093178738 + 0.00147423331914216i;3.36000000000000e-07 + 0.00000000000000i,1.74987904224595 + 0.00147730889694130i;3.37000000000000e-07 + 0.00000000000000i,1.75146988390548 + 0.00148041311865720i;3.38000000000000e-07 + 0.00000000000000i,1.75305334057945 + 0.00148353823242134i;3.39000000000000e-07 + 0.00000000000000i,1.75462936430149 + 0.00148670006961004i;3.40000000000000e-07 + 0.00000000000000i,1.75619799839122 + 0.00148988414091725i;3.41000000000000e-07 + 0.00000000000000i,1.75775873412453 + 0.00149308293913828i;3.42000000000000e-07 + 0.00000000000000i,1.75931370635954 + 0.00149632442472836i;3.43000000000000e-07 + 0.00000000000000i,1.76086035900408 + 0.00149957287323926i;3.44000000000000e-07 + 0.00000000000000i,1.76239968136243 + 0.00150285266272347i;3.45000000000000e-07 + 0.00000000000000i,1.76392771104487 + 0.00150612345670125i;3.46000000000000e-07 + 0.00000000000000i,1.76545388312476 + 0.00150946623675784i;3.47000000000000e-07 + 0.00000000000000i,1.76697243600895 + 0.00151281133035823i;3.48000000000000e-07 + 0.00000000000000i,1.76848508407833 + 0.00151620106348801i;3.49000000000000e-07 + 0.00000000000000i,1.76998958579313 + 0.00151959482479405i;3.50000000000000e-07 + 0.00000000000000i,1.77148775985479 + 0.00152301268960187i;3.51000000000000e-07 + 0.00000000000000i,1.77297894158046 + 0.00152645022943975i;3.52000000000000e-07 + 0.00000000000000i,1.77446413369808 + 0.00152992537042472i;3.53000000000000e-07 + 0.00000000000000i,1.77594304560590 + 0.00153342534313245i;3.54000000000000e-07 + 0.00000000000000i,1.77741554491609 + 0.00153694820921115i;3.55000000000000e-07 + 0.00000000000000i,1.77888057836791 + 0.00154047962369446i;3.56000000000000e-07 + 0.00000000000000i,1.78033996649230 + 0.00154404734035973i;3.57000000000000e-07 + 0.00000000000000i,1.78179209781914 + 0.00154761499137786i;3.58000000000000e-07 + 0.00000000000000i,1.78323929072185 + 0.00155123645364595i;3.59000000000000e-07 + 0.00000000000000i,1.78468001384762 + 0.00155486522871240i;3.60000000000000e-07 + 0.00000000000000i,1.78611456970647 + 0.00155852869222942i;3.61000000000000e-07 + 0.00000000000000i,1.78754203802868 + 0.00156218892151218i;3.62000000000000e-07 + 0.00000000000000i,1.78896509836034 + 0.00156589617355451i;3.63000000000000e-07 + 0.00000000000000i,1.79038127390134 + 0.00156961722369753i;3.64000000000000e-07 + 0.00000000000000i,1.79179126305308 + 0.00157336039809618i;3.65000000000000e-07 + 0.00000000000000i,1.79319222457674 + 0.00157711394217456i;3.66000000000000e-07 + 0.00000000000000i,1.79459051974377 + 0.00158088752769573i;3.67000000000000e-07 + 0.00000000000000i,1.79598311139707 + 0.00158469125849679i;3.68000000000000e-07 + 0.00000000000000i,1.79736992715432 + 0.00158851585606745i;3.69000000000000e-07 + 0.00000000000000i,1.79875225632817 + 0.00159239322425393i;3.70000000000000e-07 + 0.00000000000000i,1.80012781804629 + 0.00159626042672048i;3.71000000000000e-07 + 0.00000000000000i,1.80149833115086 + 0.00160016195421433i;3.72000000000000e-07 + 0.00000000000000i,1.80286262457116 + 0.00160407136801401i;3.73000000000000e-07 + 0.00000000000000i,1.80422215541098 + 0.00160801490979747i;3.74000000000000e-07 + 0.00000000000000i,1.80557600140739 + 0.00161197494638285i;3.75000000000000e-07 + 0.00000000000000i,1.80692524370656 + 0.00161597282520986i;3.76000000000000e-07 + 0.00000000000000i,1.80826802985703 + 0.00161997046118592i;3.77000000000000e-07 + 0.00000000000000i,1.80960534630446 + 0.00162398648425960i;3.78000000000000e-07 + 0.00000000000000i,1.81093836857279 + 0.00162804500002957i;3.79000000000000e-07 + 0.00000000000000i,1.81226637953596 + 0.00163212379406145i;3.80000000000000e-07 + 0.00000000000000i,1.81358808127771 + 0.00163620674289729i;3.81000000000000e-07 + 0.00000000000000i,1.81490655759756 + 0.00164034519993331i;3.82000000000000e-07 + 0.00000000000000i,1.81621899089087 + 0.00164448422301137i;3.83000000000000e-07 + 0.00000000000000i,1.81752553010673 + 0.00164862366838459i;3.84000000000000e-07 + 0.00000000000000i,1.81882890831362 + 0.00165283532131696i;3.85000000000000e-07 + 0.00000000000000i,1.82012235618920 + 0.00165701318745802i;3.86000000000000e-07 + 0.00000000000000i,1.82141657981171 + 0.00166126865467478i;3.87000000000000e-07 + 0.00000000000000i,1.82270313065385 + 0.00166549231788918i;3.88000000000000e-07 + 0.00000000000000i,1.82398657451298 + 0.00166977370396101i;3.89000000000000e-07 + 0.00000000000000i,1.82526598143553 + 0.00167409824382783i;3.90000000000000e-07 + 0.00000000000000i,1.82653923595560 + 0.00167840864399308i;3.91000000000000e-07 + 0.00000000000000i,1.82780759798177 + 0.00168272588179702i;3.92000000000000e-07 + 0.00000000000000i,1.82907253805599 + 0.00168711060053977i;3.93000000000000e-07 + 0.00000000000000i,1.83033249477071 + 0.00169149713645157i;3.94000000000000e-07 + 0.00000000000000i,1.83158940585805 + 0.00169593312703596i;3.95000000000000e-07 + 0.00000000000000i,1.83283882755365 + 0.00170034327017507i;3.96000000000000e-07 + 0.00000000000000i,1.83408607644380 + 0.00170481834243976i;3.97000000000000e-07 + 0.00000000000000i,1.83532847011797 + 0.00170930418317384i;3.98000000000000e-07 + 0.00000000000000i,1.83656699093094 + 0.00171381769704493i;3.99000000000000e-07 + 0.00000000000000i,1.83780056774426 + 0.00171834980026714i;4.00000000000000e-07 + 0.00000000000000i,1.83903002271304 + 0.00172291048121861i;4.01000000000000e-07 + 0.00000000000000i,1.84025587484730 + 0.00172749936776950i;4.02000000000000e-07 + 0.00000000000000i,1.84147811843003 + 0.00173212021640690i;4.03000000000000e-07 + 0.00000000000000i,1.84269403002587 + 0.00173673350294170i;4.04000000000000e-07 + 0.00000000000000i,1.84390662337643 + 0.00174138820694490i;4.05000000000000e-07 + 0.00000000000000i,1.84511220060662 + 0.00174605248868947i;4.06000000000000e-07 + 0.00000000000000i,1.84631675537431 + 0.00175075058285754i;4.07000000000000e-07 + 0.00000000000000i,1.84751858540636 + 0.00175550243420484i;4.08000000000000e-07 + 0.00000000000000i,1.84871514018898 + 0.00176025045288474i;4.09000000000000e-07 + 0.00000000000000i,1.84990753062482 + 0.00176502206004692i;4.10000000000000e-07 + 0.00000000000000i,1.85109687812971 + 0.00176983633166476i;4.11000000000000e-07 + 0.00000000000000i,1.85228181034050 + 0.00177465935312769i;4.12000000000000e-07 + 0.00000000000000i,1.85346314888572 + 0.00177951314244162i;4.13000000000000e-07 + 0.00000000000000i,1.85464102640091 + 0.00178440231035227i;4.14000000000000e-07 + 0.00000000000000i,1.85581510301293 + 0.00178931225428180i;4.15000000000000e-07 + 0.00000000000000i,1.85698569392653 + 0.00179425817917427i;4.16000000000000e-07 + 0.00000000000000i,1.85815264232954 + 0.00179922706378329i;4.17000000000000e-07 + 0.00000000000000i,1.85931512736326 + 0.00180420761377115i;4.18000000000000e-07 + 0.00000000000000i,1.86047470328533 + 0.00180922719693666i;4.19000000000000e-07 + 0.00000000000000i,1.86163012733487 + 0.00181425488134379i;4.20000000000000e-07 + 0.00000000000000i,1.86278352013406 + 0.00181935079225724i;4.21000000000000e-07 + 0.00000000000000i,1.86393209291267 + 0.00182444236272164i;4.22000000000000e-07 + 0.00000000000000i,1.86507861164554 + 0.00182958766757327i;4.23000000000000e-07 + 0.00000000000000i,1.86622112463386 + 0.00183475583016547i;4.24000000000000e-07 + 0.00000000000000i,1.86735959062016 + 0.00183993167358635i;4.25000000000000e-07 + 0.00000000000000i,1.86849133719953 + 0.00184511806390707i;4.26000000000000e-07 + 0.00000000000000i,1.86962416577585 + 0.00185037705311554i;4.27000000000000e-07 + 0.00000000000000i,1.87075259853740 + 0.00185564521407337i;4.28000000000000e-07 + 0.00000000000000i,1.87187771422661 + 0.00186093163886562i;4.29000000000000e-07 + 0.00000000000000i,1.87300013093932 + 0.00186626531666024i;4.30000000000000e-07 + 0.00000000000000i,1.87411992471380 + 0.00187163194319065i;4.31000000000000e-07 + 0.00000000000000i,1.87523559966794 + 0.00187702005961184i;4.32000000000000e-07 + 0.00000000000000i,1.87634917569841 + 0.00188244393055802i;4.33000000000000e-07 + 0.00000000000000i,1.87745878926350 + 0.00188788825480814i;4.34000000000000e-07 + 0.00000000000000i,1.87856630926826 + 0.00189338130170937i;4.35000000000000e-07 + 0.00000000000000i,1.87966952396958 + 0.00189888501829720i;4.36000000000000e-07 + 0.00000000000000i,1.88077066810333 + 0.00190443131761886i;4.37000000000000e-07 + 0.00000000000000i,1.88186841375670 + 0.00191000220028252i;4.38000000000000e-07 + 0.00000000000000i,1.88296292572583 + 0.00191560454908648i;4.39000000000000e-07 + 0.00000000000000i,1.88405536348606 + 0.00192124900439793i;4.40000000000000e-07 + 0.00000000000000i,1.88514491703043 + 0.00192692421970415i;4.41000000000000e-07 + 0.00000000000000i,1.88623163125229 + 0.00193262769332328i;4.42000000000000e-07 + 0.00000000000000i,1.88731549665145 + 0.00193836474666023i;4.43000000000000e-07 + 0.00000000000000i,1.88839627019691 + 0.00194413028082064i;4.44000000000000e-07 + 0.00000000000000i,1.88947465213596 + 0.00194993625301442i;4.45000000000000e-07 + 0.00000000000000i,1.89054625931205 + 0.00195574176784929i;4.46000000000000e-07 + 0.00000000000000i,1.89161831557018 + 0.00196160259092623i;4.47000000000000e-07 + 0.00000000000000i,1.89268849073382 + 0.00196750026013018i;4.48000000000000e-07 + 0.00000000000000i,1.89375596310141 + 0.00197343889056417i;4.49000000000000e-07 + 0.00000000000000i,1.89482130775195 + 0.00197941980245990i;4.50000000000000e-07 + 0.00000000000000i,1.89588221395259 + 0.00198539371282901i;4.51000000000000e-07 + 0.00000000000000i,1.89694224827319 + 0.00199144248824465i;4.52000000000000e-07 + 0.00000000000000i,1.89799931377686 + 0.00199751321484539i;4.53000000000000e-07 + 0.00000000000000i,1.89905474388600 + 0.00200363331139785i;4.54000000000000e-07 + 0.00000000000000i,1.90010690544823 + 0.00200977280231883i;4.55000000000000e-07 + 0.00000000000000i,1.90115578627566 + 0.00201594108673020i;4.56000000000000e-07 + 0.00000000000000i,1.90220400468826 + 0.00202216581069096i;4.57000000000000e-07 + 0.00000000000000i,1.90324863105082 + 0.00202841388193373i;4.58000000000000e-07 + 0.00000000000000i,1.90429121299996 + 0.00203470335861525i;4.59000000000000e-07 + 0.00000000000000i,1.90533232345102 + 0.00204103869300196i;4.60000000000000e-07 + 0.00000000000000i,1.90636877712514 + 0.00204736861625045i;4.61000000000000e-07 + 0.00000000000000i,1.90740451484382 + 0.00205376072635346i;4.62000000000000e-07 + 0.00000000000000i,1.90843949336016 + 0.00206021696538655i;4.63000000000000e-07 + 0.00000000000000i,1.90947049598375 + 0.00206668466888168i;4.64000000000000e-07 + 0.00000000000000i,1.91049891770889 + 0.00207319364929542i;4.65000000000000e-07 + 0.00000000000000i,1.91152213566498 + 0.00207971251521559i;4.66000000000000e-07 + 0.00000000000000i,1.91254714025844 + 0.00208630566948273i;4.67000000000000e-07 + 0.00000000000000i,1.91356903357632 + 0.00209291339076864i;4.68000000000000e-07 + 0.00000000000000i,1.91458946287397 + 0.00209958089552998i;4.69000000000000e-07 + 0.00000000000000i,1.91560849718779 + 0.00210629016146647i;4.70000000000000e-07 + 0.00000000000000i,1.91662379422786 + 0.00211301293671944i;4.71000000000000e-07 + 0.00000000000000i,1.91763792752911 + 0.00211978749187347i;4.72000000000000e-07 + 0.00000000000000i,1.91865063880365 + 0.00212661515114643i;4.73000000000000e-07 + 0.00000000000000i,1.91966017850866 + 0.00213345894361977i;4.74000000000000e-07 + 0.00000000000000i,1.92066847387940 + 0.00214035825883174i;4.75000000000000e-07 + 0.00000000000000i,1.92167505214156 + 0.00214729595587358i;4.76000000000000e-07 + 0.00000000000000i,1.92267873354378 + 0.00215426271161002i;4.77000000000000e-07 + 0.00000000000000i,1.92368110858283 + 0.00216127538980556i;4.78000000000000e-07 + 0.00000000000000i,1.92468178467607 + 0.00216833700339610i;4.79000000000000e-07 + 0.00000000000000i,1.92568003951556 + 0.00217542741064026i;4.80000000000000e-07 + 0.00000000000000i,1.92667647213554 + 0.00218255534841364i;4.81000000000000e-07 + 0.00000000000000i,1.92767189627519 + 0.00218974177767801i;4.82000000000000e-07 + 0.00000000000000i,1.92866619237526 + 0.00219697679194740i;4.83000000000000e-07 + 0.00000000000000i,1.92965662585999 + 0.00220421775798699i;4.84000000000000e-07 + 0.00000000000000i,1.93064703350765 + 0.00221153373123242i;4.85000000000000e-07 + 0.00000000000000i,1.93163104130911 + 0.00221884877409592i;4.86000000000000e-07 + 0.00000000000000i,1.93261674182496 + 0.00222621852365883i;4.87000000000000e-07 + 0.00000000000000i,1.93360147172774 + 0.00223365393246523i;4.88000000000000e-07 + 0.00000000000000i,1.93458436962287 + 0.00224112503663377i;4.89000000000000e-07 + 0.00000000000000i,1.93556538845295 + 0.00224863230371076i;4.90000000000000e-07 + 0.00000000000000i,1.93654544251959 + 0.00225619495165908i;4.91000000000000e-07 + 0.00000000000000i,1.93752338227597 + 0.00226378515920538i;4.92000000000000e-07 + 0.00000000000000i,1.93849950167833 + 0.00227142388170088i;4.93000000000000e-07 + 0.00000000000000i,1.93947396329723 + 0.00227910590392156i;4.94000000000000e-07 + 0.00000000000000i,1.94044737284516 + 0.00228683131043292i;4.95000000000000e-07 + 0.00000000000000i,1.94141878884862 + 0.00229459116846011i;4.96000000000000e-07 + 0.00000000000000i,1.94238832792069 + 0.00230239401508111i;4.97000000000000e-07 + 0.00000000000000i,1.94335681344650 + 0.00231024645850913i;4.98000000000000e-07 + 0.00000000000000i,1.94432409658822 + 0.00231814557080315i;4.99000000000000e-07 + 0.00000000000000i,1.94528992000961 + 0.00232609204625742i;5.00000000000000e-07 + 0.00000000000000i,1.94625342371424 + 0.00233406159168724i];
d = Data(:,1);neff = (Data(:,2));perm = neff.^2;

% figure
% 
% plot(d*1e9,real(perm));
% figure
% plot(d*1e9,imag(perm));

figure;
yyaxis right;
plot(d*1e9,abs(real(neff)));
set(gcf, 'Position', [00, 00, 400, 300]);
ylabel('Real index');
xlabel('Waveguide width');
yyaxis left;
hold on;
plot(d*1e9,imag(neff));
ylabel('Imaginary index');
xlabel('Waveguide width');
legend(["Imaginary Index","Real Index"])

k0 = 2*pi/1550e-5;
L = 20e-6;
M = 300;
ne = 1.8;
z = -L/2:(L/(M - 1)):L/2;
wz = 2*ne*z/L;
permz = wz.^2;
figure;
plot(z,permz);

for ind = 1:1:M
    [~,inx] = min(abs((real(permz(ind) - perm)))); 
    d_Al(ind) = d(inx); 
    eps(ind) = perm(inx); 
end

figure;yyaxis left;
plot(z*1e6,real(eps));set(gcf, 'Position', [00, 00, 400, 300]);xlabel('x(\mum)');ylabel('Re[\epsilon]');yyaxis right
plot(z*1e6,imag(eps));set(gcf, 'Position', [00, 00, 400, 300]);xlabel('x(\mum)');ylabel('Im[\epsilon]');

figure;
plot(z*1e6,d_Al*1e9);
set(gcf, 'Position', [00, 00, 400, 300]);
xlabel('x(\mum)');
ylabel('Waveguide width(nm)')

figure;
plot(z,imag(eps))

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%For Comsol Geometry
% a = 0.181/0.161 - 1;
a = 0.161/0.161 - 1;
gc = -a*(abs(2*z/L)).^2 + a + 1;
Al_Y = [d_Al.*gc*1e6 -d_Al.*gc*1e6]/2;
Al_Y_h = Al_Y';
Al_Z = [z -z]*1e6;
Al_Z_h = Al_Z';
% Al_Y = [d_Al-0.0e-6 -d_Al+0.0e-6]/2*1e6;Al_Z = [z -z]*1e6;
% PumpSweep = unique(Lx_Al_Com)*1e9;
SiO_Y = [d_Al + 200e-9 -d_Al - 200e-9]/2*1e6;
SiO_Z = [z -z];


% % %%%%3.3^2 +(0.03*exp(-((z-5.168[um])/2[um])^2) + 0.03*exp(-((z+5.168[um])/2[um])^2) + 0.017*exp(-(z/10[um])^2))*i
% % tm = 0.03*exp(-((z-5.168e-6)/2e-6).^2) + 0.03*exp(-((z+5.168e-6)/2e-6).^2) + 0.017*exp(-(z/10e-6).^2);
% % figure
% % plot(z,tm)