clc
clear all
% close all

% Htop = 3*Ht
Data = [1.32000000000000e-07 + 0.00000000000000i,0.0555834265524353 + 0.106636616375673i;1.33000000000000e-07 + 0.00000000000000i,0.157808155549551 + 0.0372520166957571i;1.34000000000000e-07 + 0.00000000000000i,0.235671371836042 + 0.0247415185019498i;1.35000000000000e-07 + 0.00000000000000i,0.293830281967581 + 0.0196831024648079i;1.36000000000000e-07 + 0.00000000000000i,0.341884071500736 + 0.0167802392356354i;1.37000000000000e-07 + 0.00000000000000i,0.383536394605887 + 0.0148375061767422i;1.38000000000000e-07 + 0.00000000000000i,0.420695449146817 + 0.0134189284325080i;1.39000000000000e-07 + 0.00000000000000i,0.454446539455235 + 0.0123232878096381i;1.40000000000000e-07 + 0.00000000000000i,0.485502711816986 + 0.0114431604548680i;1.41000000000000e-07 + 0.00000000000000i,0.514367037805409 + 0.0107154116148968i;1.42000000000000e-07 + 0.00000000000000i,0.541391972067297 + 0.0101001320806447i;1.43000000000000e-07 + 0.00000000000000i,0.566834368424563 + 0.00957042664534208i;1.44000000000000e-07 + 0.00000000000000i,0.590913245351408 + 0.00910782054267543i;1.45000000000000e-07 + 0.00000000000000i,0.613793888625002 + 0.00869906638596395i;1.46000000000000e-07 + 0.00000000000000i,0.635605573727662 + 0.00833405676652408i;1.47000000000000e-07 + 0.00000000000000i,0.656461913354457 + 0.00800530228730177i;1.48000000000000e-07 + 0.00000000000000i,0.676456967854661 + 0.00770694255119477i;1.49000000000000e-07 + 0.00000000000000i,0.695660965858347 + 0.00743417200243063i;1.50000000000000e-07 + 0.00000000000000i,0.714152038627425 + 0.00718351386404694i;1.51000000000000e-07 + 0.00000000000000i,0.731979932635522 + 0.00695177251706258i;1.52000000000000e-07 + 0.00000000000000i,0.749196968931811 + 0.00673646912665911i;1.53000000000000e-07 + 0.00000000000000i,0.765852044002579 + 0.00653570430250089i;1.54000000000000e-07 + 0.00000000000000i,0.781976926425300 + 0.00634756649043456i;1.55000000000000e-07 + 0.00000000000000i,0.797614765565584 + 0.00617090936458186i;1.56000000000000e-07 + 0.00000000000000i,0.812788183113146 + 0.00600434704598107i;1.57000000000000e-07 + 0.00000000000000i,0.827534778445318 + 0.00584724797206151i;1.58000000000000e-07 + 0.00000000000000i,0.841870093186513 + 0.00569866488886999i;1.59000000000000e-07 + 0.00000000000000i,0.855826323350340 + 0.00555838840145429i;1.60000000000000e-07 + 0.00000000000000i,0.869417844230946 + 0.00542592353376663i;1.61000000000000e-07 + 0.00000000000000i,0.882670455885783 + 0.00530127009213349i;1.62000000000000e-07 + 0.00000000000000i,0.895593927838111 + 0.00518409209735444i;1.63000000000000e-07 + 0.00000000000000i,0.908207265230719 + 0.00507433210285064i;1.64000000000000e-07 + 0.00000000000000i,0.920523000139376 + 0.00497183173731793i;1.65000000000000e-07 + 0.00000000000000i,0.932557007142142 + 0.00487615003937680i;1.66000000000000e-07 + 0.00000000000000i,0.944322090339128 + 0.00478692499066340i;1.67000000000000e-07 + 0.00000000000000i,0.955828147487050 + 0.00470350145357166i;1.68000000000000e-07 + 0.00000000000000i,0.967086698462743 + 0.00462522452671095i;1.69000000000000e-07 + 0.00000000000000i,0.978105666558913 + 0.00455136290369616i;1.70000000000000e-07 + 0.00000000000000i,0.988894661545021 + 0.00448128449956432i;1.71000000000000e-07 + 0.00000000000000i,0.999466968266838 + 0.00441455132521240i;1.72000000000000e-07 + 0.00000000000000i,1.00982827192213 + 0.00435063482305668i;1.73000000000000e-07 + 0.00000000000000i,1.01998658376105 + 0.00428915625888752i;1.74000000000000e-07 + 0.00000000000000i,1.02994767196261 + 0.00422975839272914i;1.75000000000000e-07 + 0.00000000000000i,1.03972100695972 + 0.00417232220568465i;1.76000000000000e-07 + 0.00000000000000i,1.04931146075998 + 0.00411658105980173i;1.77000000000000e-07 + 0.00000000000000i,1.05873128102041 + 0.00406260343138630i;1.78000000000000e-07 + 0.00000000000000i,1.06798072175885 + 0.00401012903749180i;1.79000000000000e-07 + 0.00000000000000i,1.07706786637390 + 0.00395914436842713i;1.80000000000000e-07 + 0.00000000000000i,1.08599614423083 + 0.00390954225905971i;1.81000000000000e-07 + 0.00000000000000i,1.09477214085195 + 0.00386127074061715i;1.82000000000000e-07 + 0.00000000000000i,1.10340051861369 + 0.00381432296236329i;1.83000000000000e-07 + 0.00000000000000i,1.11188442729993 + 0.00376859650976249i;1.84000000000000e-07 + 0.00000000000000i,1.12023476003632 + 0.00372422468625863i;1.85000000000000e-07 + 0.00000000000000i,1.12844115692400 + 0.00368088550630091i;1.86000000000000e-07 + 0.00000000000000i,1.13652245425920 + 0.00363875877614912i;1.87000000000000e-07 + 0.00000000000000i,1.14447686326419 + 0.00359772988189268i;1.88000000000000e-07 + 0.00000000000000i,1.15230823664530 + 0.00355778895738817i;1.89000000000000e-07 + 0.00000000000000i,1.16002253368489 + 0.00351897122217168i;1.90000000000000e-07 + 0.00000000000000i,1.16762018674234 + 0.00348114830675526i;1.91000000000000e-07 + 0.00000000000000i,1.17510271302235 + 0.00344427872687255i;1.92000000000000e-07 + 0.00000000000000i,1.18247499995436 + 0.00340834314193148i;1.93000000000000e-07 + 0.00000000000000i,1.18974158915637 + 0.00337338267827644i;1.94000000000000e-07 + 0.00000000000000i,1.19690441581637 + 0.00333933819436398i;1.95000000000000e-07 + 0.00000000000000i,1.20396431413813 + 0.00330615761818800i;1.96000000000000e-07 + 0.00000000000000i,1.21092463871847 + 0.00327376470317796i;1.97000000000000e-07 + 0.00000000000000i,1.21779039556349 + 0.00324225420220926i;1.98000000000000e-07 + 0.00000000000000i,1.22456371061236 + 0.00321159501139132i;1.99000000000000e-07 + 0.00000000000000i,1.23124251840059 + 0.00318163234234279i;2.00000000000000e-07 + 0.00000000000000i,1.23783371655803 + 0.00315248135811870i;2.01000000000000e-07 + 0.00000000000000i,1.24433622507790 + 0.00312402440098782i;2.02000000000000e-07 + 0.00000000000000i,1.25075467815117 + 0.00309629600025329i;2.03000000000000e-07 + 0.00000000000000i,1.25708783393536 + 0.00306922099051721i;2.04000000000000e-07 + 0.00000000000000i,1.26333735411000 + 0.00304280817716744i;2.05000000000000e-07 + 0.00000000000000i,1.26950976518626 + 0.00301703673227965i;2.06000000000000e-07 + 0.00000000000000i,1.27560630607612 + 0.00299196322920808i;2.07000000000000e-07 + 0.00000000000000i,1.28162584193581 + 0.00296745633499563i;2.08000000000000e-07 + 0.00000000000000i,1.28757099640889 + 0.00294353005359244i;2.09000000000000e-07 + 0.00000000000000i,1.29344430815130 + 0.00292019047988639i;2.10000000000000e-07 + 0.00000000000000i,1.29924714448798 + 0.00289746616809323i;2.11000000000000e-07 + 0.00000000000000i,1.30497948540616 + 0.00287525341185890i;2.12000000000000e-07 + 0.00000000000000i,1.31064370391914 + 0.00285354731496685i;2.13000000000000e-07 + 0.00000000000000i,1.31624226177781 + 0.00283241089710172i;2.14000000000000e-07 + 0.00000000000000i,1.32177265088711 + 0.00281170645021027i;2.15000000000000e-07 + 0.00000000000000i,1.32724247843409 + 0.00279157030738302i;2.16000000000000e-07 + 0.00000000000000i,1.33264875061155 + 0.00277188400736863i;2.17000000000000e-07 + 0.00000000000000i,1.33799460274458 + 0.00275268119177646i;2.18000000000000e-07 + 0.00000000000000i,1.34327837716312 + 0.00273388981765702i;2.19000000000000e-07 + 0.00000000000000i,1.34850449649951 + 0.00271556155646042i;2.20000000000000e-07 + 0.00000000000000i,1.35367279215118 + 0.00269767593332433i;2.21000000000000e-07 + 0.00000000000000i,1.35878459110421 + 0.00268021214934003i;2.22000000000000e-07 + 0.00000000000000i,1.36384145133641 + 0.00266319311127987i;2.23000000000000e-07 + 0.00000000000000i,1.36884212849631 + 0.00264650111901574i;2.24000000000000e-07 + 0.00000000000000i,1.37378895312192 + 0.00263019065984686i;2.25000000000000e-07 + 0.00000000000000i,1.37868187720888 + 0.00261432707138757i;2.26000000000000e-07 + 0.00000000000000i,1.38352556401512 + 0.00259880843195089i;2.27000000000000e-07 + 0.00000000000000i,1.38831885654562 + 0.00258362888187760i;2.28000000000000e-07 + 0.00000000000000i,1.39306361169745 + 0.00256884931671143i;2.29000000000000e-07 + 0.00000000000000i,1.39775849793585 + 0.00255439231206475i;2.30000000000000e-07 + 0.00000000000000i,1.40240621324196 + 0.00254029491355424i;2.31000000000000e-07 + 0.00000000000000i,1.40700689291087 + 0.00252651583507927i;2.32000000000000e-07 + 0.00000000000000i,1.41156233757729 + 0.00251308893695410i;2.33000000000000e-07 + 0.00000000000000i,1.41607090793577 + 0.00249992546857365i;2.34000000000000e-07 + 0.00000000000000i,1.42053487317929 + 0.00248709948723383i;2.35000000000000e-07 + 0.00000000000000i,1.42495573360429 + 0.00247457255574777i;2.36000000000000e-07 + 0.00000000000000i,1.42933395341339 + 0.00246235348110978i;2.37000000000000e-07 + 0.00000000000000i,1.43367011908556 + 0.00245042228888969i;2.38000000000000e-07 + 0.00000000000000i,1.43796490362525 + 0.00243878077413900i;2.39000000000000e-07 + 0.00000000000000i,1.44221786531473 + 0.00242740340968811i;2.40000000000000e-07 + 0.00000000000000i,1.44643072300921 + 0.00241629822782943i;2.41000000000000e-07 + 0.00000000000000i,1.45060514147708 + 0.00240548442381286i;2.42000000000000e-07 + 0.00000000000000i,1.45473908004031 + 0.00239490387787903i;2.43000000000000e-07 + 0.00000000000000i,1.45883456863110 + 0.00238455133798488i;2.44000000000000e-07 + 0.00000000000000i,1.46288981403986 + 0.00237447499597451i;2.45000000000000e-07 + 0.00000000000000i,1.46691062533160 + 0.00236462823642922i;2.46000000000000e-07 + 0.00000000000000i,1.47089834856856 + 0.00235509277588281i;2.47000000000000e-07 + 0.00000000000000i,1.47484637301453 + 0.00234570458598338i;2.48000000000000e-07 + 0.00000000000000i,1.47876180191842 + 0.00233662681608203i;2.49000000000000e-07 + 0.00000000000000i,1.48263995896706 + 0.00232770963371464i;2.50000000000000e-07 + 0.00000000000000i,1.48648547214607 + 0.00231904430827650i;2.51000000000000e-07 + 0.00000000000000i,1.49029773466339 + 0.00231060824665374i;2.52000000000000e-07 + 0.00000000000000i,1.49407698376217 + 0.00230239245083582i;2.53000000000000e-07 + 0.00000000000000i,1.49781993008682 + 0.00229431076749891i;2.54000000000000e-07 + 0.00000000000000i,1.50153420615511 + 0.00228651252725074i;2.55000000000000e-07 + 0.00000000000000i,1.50521600741011 + 0.00227888924014287i;2.56000000000000e-07 + 0.00000000000000i,1.50886728636929 + 0.00227147524074066i;2.57000000000000e-07 + 0.00000000000000i,1.51248750202651 + 0.00226424972038116i;2.58000000000000e-07 + 0.00000000000000i,1.51607730259267 + 0.00225721808098264i;2.59000000000000e-07 + 0.00000000000000i,1.51963579289846 + 0.00225032877543419i;2.60000000000000e-07 + 0.00000000000000i,1.52316636750298 + 0.00224366644817370i;2.61000000000000e-07 + 0.00000000000000i,1.52666729257323 + 0.00223716090903785i;2.62000000000000e-07 + 0.00000000000000i,1.53014009201863 + 0.00223087630616549i;2.63000000000000e-07 + 0.00000000000000i,1.53358331649789 + 0.00222469784601803i;2.64000000000000e-07 + 0.00000000000000i,1.53700011646146 + 0.00221873994345497i;2.65000000000000e-07 + 0.00000000000000i,1.54038574409731 + 0.00221293491190532i;2.66000000000000e-07 + 0.00000000000000i,1.54374710202464 + 0.00220726694644624i;2.67000000000000e-07 + 0.00000000000000i,1.54708324408640 + 0.00220180573392909i;2.68000000000000e-07 + 0.00000000000000i,1.55039200007260 + 0.00219649673521329i;2.69000000000000e-07 + 0.00000000000000i,1.55367391088028 + 0.00219130283925276i;2.70000000000000e-07 + 0.00000000000000i,1.55693161487572 + 0.00218630129126686i;2.71000000000000e-07 + 0.00000000000000i,1.56016391077888 + 0.00218144897819646i;2.72000000000000e-07 + 0.00000000000000i,1.56337026315421 + 0.00217672133987969i;2.73000000000000e-07 + 0.00000000000000i,1.56655360937670 + 0.00217217731156961i;2.74000000000000e-07 + 0.00000000000000i,1.56971146811343 + 0.00216773661259692i;2.75000000000000e-07 + 0.00000000000000i,1.57284507971502 + 0.00216343286419410i;2.76000000000000e-07 + 0.00000000000000i,1.57595796741016 + 0.00215931805558413i;2.77000000000000e-07 + 0.00000000000000i,1.57904418441229 + 0.00215528004737893i;2.78000000000000e-07 + 0.00000000000000i,1.58210994156692 + 0.00215143667623788i;2.79000000000000e-07 + 0.00000000000000i,1.58515158049583 + 0.00214768780720061i;2.80000000000000e-07 + 0.00000000000000i,1.58817084387291 + 0.00214406588973776i;2.81000000000000e-07 + 0.00000000000000i,1.59116777884561 + 0.00214056732796134i;2.82000000000000e-07 + 0.00000000000000i,1.59414239292526 + 0.00213720161719774i;2.83000000000000e-07 + 0.00000000000000i,1.59709674440315 + 0.00213395485679548i;2.84000000000000e-07 + 0.00000000000000i,1.60002602135530 + 0.00213081176831648i;2.85000000000000e-07 + 0.00000000000000i,1.60293787985383 + 0.00212783766806963i;2.86000000000000e-07 + 0.00000000000000i,1.60582940640781 + 0.00212496726076986i;2.87000000000000e-07 + 0.00000000000000i,1.60869660694936 + 0.00212213929759359i;2.88000000000000e-07 + 0.00000000000000i,1.61154602020650 + 0.00211946541537432i;2.89000000000000e-07 + 0.00000000000000i,1.61437638885543 + 0.00211693453246077i;2.90000000000000e-07 + 0.00000000000000i,1.61718592562146 + 0.00211449243123661i;2.91000000000000e-07 + 0.00000000000000i,1.61997705233134 + 0.00211218350441440i;2.92000000000000e-07 + 0.00000000000000i,1.62274630042916 + 0.00210992101413009i;2.93000000000000e-07 + 0.00000000000000i,1.62549769766057 + 0.00210778906223281i;2.94000000000000e-07 + 0.00000000000000i,1.62823020987757 + 0.00210575579916152i;2.95000000000000e-07 + 0.00000000000000i,1.63094544132219 + 0.00210385271523894i;2.96000000000000e-07 + 0.00000000000000i,1.63364242593509 + 0.00210205681407564i;2.97000000000000e-07 + 0.00000000000000i,1.63631911511773 + 0.00210031489167826i;2.98000000000000e-07 + 0.00000000000000i,1.63897955239681 + 0.00209870272325244i;2.99000000000000e-07 + 0.00000000000000i,1.64162168768164 + 0.00209717606010422i;3.00000000000000e-07 + 0.00000000000000i,1.64424602443336 + 0.00209574104246583i;3.01000000000000e-07 + 0.00000000000000i,1.64685202803207 + 0.00209437563818505i;3.02000000000000e-07 + 0.00000000000000i,1.64944161507367 + 0.00209313723818770i;3.03000000000000e-07 + 0.00000000000000i,1.65201425899494 + 0.00209196262001623i;3.04000000000000e-07 + 0.00000000000000i,1.65457078998089 + 0.00209090661676594i;3.05000000000000e-07 + 0.00000000000000i,1.65710592307625 + 0.00208986970680645i;3.06000000000000e-07 + 0.00000000000000i,1.65962868405388 + 0.00208897526518321i;3.07000000000000e-07 + 0.00000000000000i,1.66213486413284 + 0.00208815047035353i;3.08000000000000e-07 + 0.00000000000000i,1.66462546381918 + 0.00208740789200234i;3.09000000000000e-07 + 0.00000000000000i,1.66710084512705 + 0.00208676572671337i;3.10000000000000e-07 + 0.00000000000000i,1.66955946978219 + 0.00208619075781674i;3.11000000000000e-07 + 0.00000000000000i,1.67200099133916 + 0.00208566389417692i;3.12000000000000e-07 + 0.00000000000000i,1.67442934277889 + 0.00208525539719897i;3.13000000000000e-07 + 0.00000000000000i,1.67684210147266 + 0.00208490249841400i;3.14000000000000e-07 + 0.00000000000000i,1.67923951760945 + 0.00208463623258271i;3.15000000000000e-07 + 0.00000000000000i,1.68162329241173 + 0.00208445529852550i;3.16000000000000e-07 + 0.00000000000000i,1.68399115787726 + 0.00208433094638726i;3.17000000000000e-07 + 0.00000000000000i,1.68634412224958 + 0.00208427658064944i;3.18000000000000e-07 + 0.00000000000000i,1.68868371529806 + 0.00208432304920315i;3.19000000000000e-07 + 0.00000000000000i,1.69100880558707 + 0.00208441943015196i;3.20000000000000e-07 + 0.00000000000000i,1.69331967078971 + 0.00208459191967129i;3.21000000000000e-07 + 0.00000000000000i,1.69561563401638 + 0.00208480089848651i;3.22000000000000e-07 + 0.00000000000000i,1.69789787096203 + 0.00208510379436792i;3.23000000000000e-07 + 0.00000000000000i,1.70016757842846 + 0.00208548692091399i;3.24000000000000e-07 + 0.00000000000000i,1.70242186072535 + 0.00208588736923044i;3.25000000000000e-07 + 0.00000000000000i,1.70466196163361 + 0.00208640446187393i;3.26000000000000e-07 + 0.00000000000000i,1.70689118090005 + 0.00208697577892093i;3.27000000000000e-07 + 0.00000000000000i,1.70910672986033 + 0.00208758668740517i;3.28000000000000e-07 + 0.00000000000000i,1.71131013914484 + 0.00208828494071504i;3.29000000000000e-07 + 0.00000000000000i,1.71350077714342 + 0.00208904614506034i;3.30000000000000e-07 + 0.00000000000000i,1.71567829306572 + 0.00208986843705083i;3.31000000000000e-07 + 0.00000000000000i,1.71784188184879 + 0.00209072928274511i;3.32000000000000e-07 + 0.00000000000000i,1.71999402427441 + 0.00209165694973353i;3.33000000000000e-07 + 0.00000000000000i,1.72213401560094 + 0.00209264722547044i;3.34000000000000e-07 + 0.00000000000000i,1.72426246751646 + 0.00209371380142674i;3.35000000000000e-07 + 0.00000000000000i,1.72637882863656 + 0.00209483298557091i;3.36000000000000e-07 + 0.00000000000000i,1.72848182476520 + 0.00209598268656308i;3.37000000000000e-07 + 0.00000000000000i,1.73057355564685 + 0.00209720389221578i;3.38000000000000e-07 + 0.00000000000000i,1.73265426140571 + 0.00209849252488747i;3.39000000000000e-07 + 0.00000000000000i,1.73472360626419 + 0.00209983857409470i;3.40000000000000e-07 + 0.00000000000000i,1.73678028641084 + 0.00210121619231849i;3.41000000000000e-07 + 0.00000000000000i,1.73882517130666 + 0.00210263885023782i;3.42000000000000e-07 + 0.00000000000000i,1.74085854255922 + 0.00210410689570545i;3.43000000000000e-07 + 0.00000000000000i,1.74288196623368 + 0.00210566104167441i;3.44000000000000e-07 + 0.00000000000000i,1.74489405619910 + 0.00210725463239668i;3.45000000000000e-07 + 0.00000000000000i,1.74689243732007 + 0.00210890025964376i;3.46000000000000e-07 + 0.00000000000000i,1.74888357955212 + 0.00211061156652717i;3.47000000000000e-07 + 0.00000000000000i,1.75086317328482 + 0.00211235036616411i;3.48000000000000e-07 + 0.00000000000000i,1.75283245821324 + 0.00211416776746545i;3.49000000000000e-07 + 0.00000000000000i,1.75479010078697 + 0.00211599181034320i;3.50000000000000e-07 + 0.00000000000000i,1.75673663575873 + 0.00211787051839273i;3.51000000000000e-07 + 0.00000000000000i,1.75867522303590 + 0.00211982515198353i;3.52000000000000e-07 + 0.00000000000000i,1.76060273030836 + 0.00212181935952760i;3.53000000000000e-07 + 0.00000000000000i,1.76252027526848 + 0.00212386105629298i;3.54000000000000e-07 + 0.00000000000000i,1.76442703708010 + 0.00212593486508984i;3.55000000000000e-07 + 0.00000000000000i,1.76632606596643 + 0.00212808863001163i;3.56000000000000e-07 + 0.00000000000000i,1.76821193356225 + 0.00213023331629636i;3.57000000000000e-07 + 0.00000000000000i,1.77008991138360 + 0.00213246104367744i;3.58000000000000e-07 + 0.00000000000000i,1.77195844387283 + 0.00213473945522832i;3.59000000000000e-07 + 0.00000000000000i,1.77381594595942 + 0.00213702782767164i;3.60000000000000e-07 + 0.00000000000000i,1.77566547769257 + 0.00213940245688444i;3.61000000000000e-07 + 0.00000000000000i,1.77750454654034 + 0.00214177764436556i;3.62000000000000e-07 + 0.00000000000000i,1.77933419003849 + 0.00214421509923602i;3.63000000000000e-07 + 0.00000000000000i,1.78115498910175 + 0.00214669674842173i;3.64000000000000e-07 + 0.00000000000000i,1.78296664868918 + 0.00214921584656286i;3.65000000000000e-07 + 0.00000000000000i,1.78476729639636 + 0.00215178450652327i;3.66000000000000e-07 + 0.00000000000000i,1.78656161662750 + 0.00215440325100339i;3.67000000000000e-07 + 0.00000000000000i,1.78834657895706 + 0.00215706436282748i;3.68000000000000e-07 + 0.00000000000000i,1.79012277156450 + 0.00215975238239688i;3.69000000000000e-07 + 0.00000000000000i,1.79188869667029 + 0.00216245890391614i;3.70000000000000e-07 + 0.00000000000000i,1.79364803277142 + 0.00216525658063663i;3.71000000000000e-07 + 0.00000000000000i,1.79539753762774 + 0.00216805039244532i;3.72000000000000e-07 + 0.00000000000000i,1.79713929088377 + 0.00217091271008096i;3.73000000000000e-07 + 0.00000000000000i,1.79887323408129 + 0.00217381362505219i;3.74000000000000e-07 + 0.00000000000000i,1.80059817910300 + 0.00217674447938966i;3.75000000000000e-07 + 0.00000000000000i,1.80231576627571 + 0.00217973552949183i;3.76000000000000e-07 + 0.00000000000000i,1.80402357573745 + 0.00218273523686735i;3.77000000000000e-07 + 0.00000000000000i,1.80572480245285 + 0.00218580430865010i;3.78000000000000e-07 + 0.00000000000000i,1.80741631913751 + 0.00218887628842433i;3.79000000000000e-07 + 0.00000000000000i,1.80910145846544 + 0.00219202141083144i;3.80000000000000e-07 + 0.00000000000000i,1.81077818997119 + 0.00219519245345536i;3.81000000000000e-07 + 0.00000000000000i,1.81244638987492 + 0.00219838810974912i;3.82000000000000e-07 + 0.00000000000000i,1.81410668175741 + 0.00220162064325783i;3.83000000000000e-07 + 0.00000000000000i,1.81575924350753 + 0.00220488589557551i;3.84000000000000e-07 + 0.00000000000000i,1.81740762943175 + 0.00220823566193635i;3.85000000000000e-07 + 0.00000000000000i,1.81904225798466 + 0.00221157627370134i;3.86000000000000e-07 + 0.00000000000000i,1.82067224650066 + 0.00221495609643584i;3.87000000000000e-07 + 0.00000000000000i,1.82229704569963 + 0.00221841324335253i;3.88000000000000e-07 + 0.00000000000000i,1.82391196332062 + 0.00222185668044822i;3.89000000000000e-07 + 0.00000000000000i,1.82551959980874 + 0.00222534672914319i;3.90000000000000e-07 + 0.00000000000000i,1.82712114366881 + 0.00222889291860633i;3.91000000000000e-07 + 0.00000000000000i,1.82871546418415 + 0.00223245633289231i;3.92000000000000e-07 + 0.00000000000000i,1.83030323207793 + 0.00223607519170739i;3.93000000000000e-07 + 0.00000000000000i,1.83188457126025 + 0.00223974797482139i;3.94000000000000e-07 + 0.00000000000000i,1.83345781668325 + 0.00224342252727405i;3.95000000000000e-07 + 0.00000000000000i,1.83502428726215 + 0.00224715151827002i;3.96000000000000e-07 + 0.00000000000000i,1.83658456152671 + 0.00225092058955239i;3.97000000000000e-07 + 0.00000000000000i,1.83813701455195 + 0.00225469970050123i;3.98000000000000e-07 + 0.00000000000000i,1.83968399988088 + 0.00225854390077238i;3.99000000000000e-07 + 0.00000000000000i,1.84122303151889 + 0.00226239671340147i;4.00000000000000e-07 + 0.00000000000000i,1.84275603921156 + 0.00226630051845980i;4.01000000000000e-07 + 0.00000000000000i,1.84428220548603 + 0.00227021691082550i;4.02000000000000e-07 + 0.00000000000000i,1.84580090606730 + 0.00227416887487283i;4.03000000000000e-07 + 0.00000000000000i,1.84731512433091 + 0.00227819144733634i;4.04000000000000e-07 + 0.00000000000000i,1.84882430238476 + 0.00228224886514714i;4.05000000000000e-07 + 0.00000000000000i,1.85032168485735 + 0.00228630846040397i;4.06000000000000e-07 + 0.00000000000000i,1.85181693884597 + 0.00229042418322611i;4.07000000000000e-07 + 0.00000000000000i,1.85330518820597 + 0.00229457573676109i;4.08000000000000e-07 + 0.00000000000000i,1.85478666942175 + 0.00229873781711626i;4.09000000000000e-07 + 0.00000000000000i,1.85626243892382 + 0.00230294488685630i;4.10000000000000e-07 + 0.00000000000000i,1.85773283000051 + 0.00230719461138097i;4.11000000000000e-07 + 0.00000000000000i,1.85919838994810 + 0.00231150575193784i;4.12000000000000e-07 + 0.00000000000000i,1.86065623573229 + 0.00231580562396329i;4.13000000000000e-07 + 0.00000000000000i,1.86210996272932 + 0.00232018304410076i;4.14000000000000e-07 + 0.00000000000000i,1.86355690962729 + 0.00232457841526974i;4.15000000000000e-07 + 0.00000000000000i,1.86499828976245 + 0.00232900489975845i;4.16000000000000e-07 + 0.00000000000000i,1.86643307942167 + 0.00233345729323837i;4.17000000000000e-07 + 0.00000000000000i,1.86786313869730 + 0.00233796298250942i;4.18000000000000e-07 + 0.00000000000000i,1.86928645755135 + 0.00234246665373111i;4.19000000000000e-07 + 0.00000000000000i,1.87070527887152 + 0.00234703111202481i;4.20000000000000e-07 + 0.00000000000000i,1.87211950977848 + 0.00235166180324136i;4.21000000000000e-07 + 0.00000000000000i,1.87352573292762 + 0.00235626844694749i;4.22000000000000e-07 + 0.00000000000000i,1.87492837713368 + 0.00236093951022273i;4.23000000000000e-07 + 0.00000000000000i,1.87632369331031 + 0.00236561889784011i;4.24000000000000e-07 + 0.00000000000000i,1.87771789826389 + 0.00237040311936401i;4.25000000000000e-07 + 0.00000000000000i,1.87910139904710 + 0.00237516282242672i;4.26000000000000e-07 + 0.00000000000000i,1.88048114800897 + 0.00237994166770060i;4.27000000000000e-07 + 0.00000000000000i,1.88185809057533 + 0.00238481348592709i;4.28000000000000e-07 + 0.00000000000000i,1.88322767290142 + 0.00238966690731412i;4.29000000000000e-07 + 0.00000000000000i,1.88459334261954 + 0.00239458377686077i;4.30000000000000e-07 + 0.00000000000000i,1.88595469070177 + 0.00239954276377070i;4.31000000000000e-07 + 0.00000000000000i,1.88731048216883 + 0.00240451837975387i;4.32000000000000e-07 + 0.00000000000000i,1.88866082719420 + 0.00240953134321241i;4.33000000000000e-07 + 0.00000000000000i,1.89000701106270 + 0.00241458838767073i;4.34000000000000e-07 + 0.00000000000000i,1.89134797598527 + 0.00241967006866922i;4.35000000000000e-07 + 0.00000000000000i,1.89268487695879 + 0.00242481573155245i;4.36000000000000e-07 + 0.00000000000000i,1.89401654926915 + 0.00242997159978038i;4.37000000000000e-07 + 0.00000000000000i,1.89534370733899 + 0.00243516982997718i;4.38000000000000e-07 + 0.00000000000000i,1.89666547844411 + 0.00244039357825708i;4.39000000000000e-07 + 0.00000000000000i,1.89798192435469 + 0.00244564024160956i;4.40000000000000e-07 + 0.00000000000000i,1.89929540869372 + 0.00245094542159165i;4.41000000000000e-07 + 0.00000000000000i,1.90060384252419 + 0.00245628818023537i;4.42000000000000e-07 + 0.00000000000000i,1.90190727426894 + 0.00246165205887757i;4.43000000000000e-07 + 0.00000000000000i,1.90320575657955 + 0.00246704675096198i;4.44000000000000e-07 + 0.00000000000000i,1.90450057331273 + 0.00247248191373521i;4.45000000000000e-07 + 0.00000000000000i,1.90578970011739 + 0.00247797518405950i;4.46000000000000e-07 + 0.00000000000000i,1.90707590260802 + 0.00248348074830995i;4.47000000000000e-07 + 0.00000000000000i,1.90835641107375 + 0.00248900310342123i;4.48000000000000e-07 + 0.00000000000000i,1.90963403565289 + 0.00249459944631937i;4.49000000000000e-07 + 0.00000000000000i,1.91090769228028 + 0.00250022609220637i;4.50000000000000e-07 + 0.00000000000000i,1.91217618987607 + 0.00250586101835415i;4.51000000000000e-07 + 0.00000000000000i,1.91344099414149 + 0.00251154843345401i;4.52000000000000e-07 + 0.00000000000000i,1.91470128977754 + 0.00251726698414314i;4.53000000000000e-07 + 0.00000000000000i,1.91595912634379 + 0.00252305164182403i;4.54000000000000e-07 + 0.00000000000000i,1.91721237602945 + 0.00252885660487070i;4.55000000000000e-07 + 0.00000000000000i,1.91845993931861 + 0.00253467875677968i;4.56000000000000e-07 + 0.00000000000000i,1.91970387909493 + 0.00254053283297602i;4.57000000000000e-07 + 0.00000000000000i,1.92094599727383 + 0.00254646707480444i;4.58000000000000e-07 + 0.00000000000000i,1.92218175623322 + 0.00255238140206588i;4.59000000000000e-07 + 0.00000000000000i,1.92341529933586 + 0.00255837735522554i;4.60000000000000e-07 + 0.00000000000000i,1.92464370493815 + 0.00256437698372887i;4.61000000000000e-07 + 0.00000000000000i,1.92586849633514 + 0.00257041679917836i;4.62000000000000e-07 + 0.00000000000000i,1.92708909519880 + 0.00257649877826706i;4.63000000000000e-07 + 0.00000000000000i,1.92830733392800 + 0.00258262781201975i;4.64000000000000e-07 + 0.00000000000000i,1.92952123525762 + 0.00258878411833997i;4.65000000000000e-07 + 0.00000000000000i,1.93072932725344 + 0.00259496970206633i;4.66000000000000e-07 + 0.00000000000000i,1.93193543475183 + 0.00260118881577915i;4.67000000000000e-07 + 0.00000000000000i,1.93313675020983 + 0.00260742944328367i;4.68000000000000e-07 + 0.00000000000000i,1.93433662365124 + 0.00261374720401567i;4.69000000000000e-07 + 0.00000000000000i,1.93553263853799 + 0.00262008256701322i;4.70000000000000e-07 + 0.00000000000000i,1.93672506528174 + 0.00262645779655275i;4.71000000000000e-07 + 0.00000000000000i,1.93791502606895 + 0.00263289654118751i;4.72000000000000e-07 + 0.00000000000000i,1.93909885645098 + 0.00263931531214768i;4.73000000000000e-07 + 0.00000000000000i,1.94028105756321 + 0.00264580457306310i;4.74000000000000e-07 + 0.00000000000000i,1.94145963561230 + 0.00265232762491146i;4.75000000000000e-07 + 0.00000000000000i,1.94263483820862 + 0.00265888536880896i;4.76000000000000e-07 + 0.00000000000000i,1.94380626441454 + 0.00266546945833483i;4.77000000000000e-07 + 0.00000000000000i,1.94497511004315 + 0.00267210187805540i;4.78000000000000e-07 + 0.00000000000000i,1.94614036588876 + 0.00267877153155130i;4.79000000000000e-07 + 0.00000000000000i,1.94730217354687 + 0.00268547065705640i;4.80000000000000e-07 + 0.00000000000000i,1.94846101615010 + 0.00269221178549509i;4.81000000000000e-07 + 0.00000000000000i,1.94961682747197 + 0.00269899510632506i;4.82000000000000e-07 + 0.00000000000000i,1.95076747726800 + 0.00270577192207878i;4.83000000000000e-07 + 0.00000000000000i,1.95191647331689 + 0.00271261778437301i;4.84000000000000e-07 + 0.00000000000000i,1.95306286745426 + 0.00271951026553026i;4.85000000000000e-07 + 0.00000000000000i,1.95420417038883 + 0.00272642496103532i;4.86000000000000e-07 + 0.00000000000000i,1.95534224554522 + 0.00273335537857089i;4.87000000000000e-07 + 0.00000000000000i,1.95647992133620 + 0.00274035888093969i;4.88000000000000e-07 + 0.00000000000000i,1.95761313548412 + 0.00274738732032781i;4.89000000000000e-07 + 0.00000000000000i,1.95874454785207 + 0.00275444985816607i;4.90000000000000e-07 + 0.00000000000000i,1.95987191036887 + 0.00276154895342884i;4.91000000000000e-07 + 0.00000000000000i,1.96099681554738 + 0.00276868468425994i;4.92000000000000e-07 + 0.00000000000000i,1.96211880158786 + 0.00277586474103670i;4.93000000000000e-07 + 0.00000000000000i,1.96323896803645 + 0.00278307901430616i;4.94000000000000e-07 + 0.00000000000000i,1.96435444902942 + 0.00279031288074541i;4.95000000000000e-07 + 0.00000000000000i,1.96546822641085 + 0.00279760524726715i;4.96000000000000e-07 + 0.00000000000000i,1.96657861381943 + 0.00280491831673959i;4.97000000000000e-07 + 0.00000000000000i,1.96768697579347 + 0.00281228520225660i;4.98000000000000e-07 + 0.00000000000000i,1.96879133924574 + 0.00281965569855865i;4.99000000000000e-07 + 0.00000000000000i,1.96989448143078 + 0.00282709993544815i;5.00000000000000e-07 + 0.00000000000000i,1.97099366149216 + 0.00283455579576163i];
d = Data(:,1);neff = (Data(:,2));perm = neff.^2;

% figure
% plot(d*1e9,real(perm));
% figure
% plot(d*1e9,imag(perm));

figure;
yyaxis right;
plot(d*1e9,abs(real(perm)));
set(gcf, 'Position', [00, 00, 400, 300]);
ylabel('Real permittivity');
xlabel('Waveguide width');
yyaxis left;
hold on;
plot(d*1e9,imag(perm));
ylabel('Imaginary permittivity');
xlabel('Waveguide width');
legend(["Imaginary permittivity","Real permittivity"])
title('PECVD 70nm SiN');
xlim([130 500])

k0 = 2*pi/1550e-5;
L = 20e-6;
M = 300;
ne = 1.8;
z = -L/2:(L/(M - 1)):L/2;
wz = 2*ne*z/L;
permz = wz.^2;
figure;
plot(z,permz);

for ind = 1:1:M
    [~,inx] = min(abs((real(permz(ind) - perm)))); 
    d_Al(ind) = d(inx); 
    eps(ind) = perm(inx); 
end

figure;yyaxis left;
plot(z*1e6,real(eps));set(gcf, 'Position', [00, 00, 400, 300]);xlabel('x(\mum)');ylabel('Re[\epsilon]');yyaxis right
plot(z*1e6,imag(eps));set(gcf, 'Position', [00, 00, 400, 300]);xlabel('x(\mum)');ylabel('Im[\epsilon]');

figure;
plot(z*1e6,d_Al*1e9);
set(gcf, 'Position', [00, 00, 400, 300]);
xlabel('x(\mum)');
ylabel('Waveguide width(nm)')

figure;
plot(z,imag(eps))

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%For Comsol Geometry
% a = 0.181/0.161 - 1;
a = 0.161/0.161 - 1;
gc = -a*(abs(2*z/L)).^2 + a + 1;
Al_Y = [d_Al.*gc*1e6 -d_Al.*gc*1e6]/2;
Al_Y_h = Al_Y';
Al_Z = [z -z]*1e6;
Al_Z_h = Al_Z';
% Al_Y = [d_Al-0.0e-6 -d_Al+0.0e-6]/2*1e6;Al_Z = [z -z]*1e6;
% PumpSweep = unique(Lx_Al_Com)*1e9;
SiO_Y = [d_Al + 200e-9 -d_Al - 200e-9]/2*1e6;
SiO_Z = [z -z];


% % %%%%3.3^2 +(0.03*exp(-((z-5.168[um])/2[um])^2) + 0.03*exp(-((z+5.168[um])/2[um])^2) + 0.017*exp(-(z/10[um])^2))*i
% % tm = 0.03*exp(-((z-5.168e-6)/2e-6).^2) + 0.03*exp(-((z+5.168e-6)/2e-6).^2) + 0.017*exp(-(z/10e-6).^2);
% % figure
% % plot(z,tm)