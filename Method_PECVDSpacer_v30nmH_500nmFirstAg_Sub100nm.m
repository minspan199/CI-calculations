clc
clear all
close all

Data = [1.50000000000000e-07 + 0.00000000000000i,0.00517049030033025 + 0.429612975119080i;1.51000000000000e-07 + 0.00000000000000i,0.00819013763372733 + 0.322512999099993i;1.52000000000000e-07 + 0.00000000000000i,0.0193575610632007 + 0.157468689520774i;1.53000000000000e-07 + 0.00000000000000i,0.232983233909317 + 0.0147752808034738i;1.54000000000000e-07 + 0.00000000000000i,0.362812204123034 + 0.0105396648809030i;1.55000000000000e-07 + 0.00000000000000i,0.456103913345998 + 0.00919315085220961i;1.56000000000000e-07 + 0.00000000000000i,0.532418810952937 + 0.00854676800064735i;1.57000000000000e-07 + 0.00000000000000i,0.598277348691008 + 0.00818490243944331i;1.58000000000000e-07 + 0.00000000000000i,0.656836563673709 + 0.00796525297998481i;1.59000000000000e-07 + 0.00000000000000i,0.709905026433055 + 0.00782604070267883i;1.60000000000000e-07 + 0.00000000000000i,0.758654595840657 + 0.00773575017316847i;1.61000000000000e-07 + 0.00000000000000i,0.803867840969280 + 0.00767643427334757i;1.62000000000000e-07 + 0.00000000000000i,0.846111599757863 + 0.00763751757755874i;1.63000000000000e-07 + 0.00000000000000i,0.885808310514697 + 0.00761077022682663i;1.64000000000000e-07 + 0.00000000000000i,0.923276327396025 + 0.00758705549849858i;1.65000000000000e-07 + 0.00000000000000i,0.958743457422284 + 0.00755570976810559i;1.66000000000000e-07 + 0.00000000000000i,0.992418205173287 + 0.00750719526502020i;1.67000000000000e-07 + 0.00000000000000i,1.02440438810979 + 0.00742754380799870i;1.68000000000000e-07 + 0.00000000000000i,1.05478584048078 + 0.00729456635982233i;1.69000000000000e-07 + 0.00000000000000i,1.08355328400880 + 0.00707102770335926i;1.70000000000000e-07 + 0.00000000000000i,1.11063113191338 + 0.00670819781180531i;1.71000000000000e-07 + 0.00000000000000i,1.13586615277701 + 0.00618037384371698i;1.72000000000000e-07 + 0.00000000000000i,1.18468566820781 + 0.00602285645999288i;1.73000000000000e-07 + 0.00000000000000i,1.20776570072608 + 0.00656483477909480i;1.74000000000000e-07 + 0.00000000000000i,1.23096320408258 + 0.00697451929552133i;1.75000000000000e-07 + 0.00000000000000i,1.25399952640813 + 0.00725868390846583i;1.76000000000000e-07 + 0.00000000000000i,1.27669096494943 + 0.00745479552912257i;1.77000000000000e-07 + 0.00000000000000i,1.29893989072679 + 0.00759451159126934i;1.78000000000000e-07 + 0.00000000000000i,1.32070303046867 + 0.00769881047358344i;1.79000000000000e-07 + 0.00000000000000i,1.34196693985791 + 0.00778017783019174i;1.80000000000000e-07 + 0.00000000000000i,1.36272054599741 + 0.00784608981496262i;1.81000000000000e-07 + 0.00000000000000i,1.38298812559740 + 0.00790170356830626i;1.82000000000000e-07 + 0.00000000000000i,1.40277369765506 + 0.00794972107734630i;1.83000000000000e-07 + 0.00000000000000i,1.42209113649728 + 0.00799216674320597i;1.84000000000000e-07 + 0.00000000000000i,1.44095777288204 + 0.00803032438253490i;1.85000000000000e-07 + 0.00000000000000i,1.45939908086563 + 0.00806526232021910i;1.86000000000000e-07 + 0.00000000000000i,1.47741903034826 + 0.00809751775228096i;1.87000000000000e-07 + 0.00000000000000i,1.49504387224526 + 0.00812774589145683i;1.88000000000000e-07 + 0.00000000000000i,1.51227873302225 + 0.00815612940087283i;1.89000000000000e-07 + 0.00000000000000i,1.52914656866680 + 0.00818301870735969i;1.90000000000000e-07 + 0.00000000000000i,1.54565290762616 + 0.00820844791429307i;1.91000000000000e-07 + 0.00000000000000i,1.56181501118970 + 0.00823264836019603i;1.92000000000000e-07 + 0.00000000000000i,1.57765136465304 + 0.00825596061320272i;1.93000000000000e-07 + 0.00000000000000i,1.59316552625876 + 0.00827833097300062i;1.94000000000000e-07 + 0.00000000000000i,1.60837072583793 + 0.00829979844933454i;1.95000000000000e-07 + 0.00000000000000i,1.62327950445361 + 0.00832053650737051i;1.96000000000000e-07 + 0.00000000000000i,1.63789753410556 + 0.00834042597247274i;1.97000000000000e-07 + 0.00000000000000i,1.65223987896434 + 0.00835974801084172i;1.98000000000000e-07 + 0.00000000000000i,1.66631355647025 + 0.00837842556432122i;1.99000000000000e-07 + 0.00000000000000i,1.68012478333776 + 0.00839638377401850i;2.00000000000000e-07 + 0.00000000000000i,1.69368348764745 + 0.00841389504290910i;2.01000000000000e-07 + 0.00000000000000i,1.70700061355761 + 0.00843082534273132i;2.02000000000000e-07 + 0.00000000000000i,1.72007584740002 + 0.00844723937305968i;2.03000000000000e-07 + 0.00000000000000i,1.73292450236057 + 0.00846317021450101i;2.04000000000000e-07 + 0.00000000000000i,1.74555026320501 + 0.00847870618045819i;2.05000000000000e-07 + 0.00000000000000i,1.75795876387608 + 0.00849375332193461i;2.06000000000000e-07 + 0.00000000000000i,1.77015722161126 + 0.00850837089069136i;2.07000000000000e-07 + 0.00000000000000i,1.78215044641202 + 0.00852256000926104i;2.08000000000000e-07 + 0.00000000000000i,1.79394615099378 + 0.00853641247550972i;2.09000000000000e-07 + 0.00000000000000i,1.80554723397978 + 0.00854987701444959i;2.10000000000000e-07 + 0.00000000000000i,1.81696104064662 + 0.00856299393241689i;2.11000000000000e-07 + 0.00000000000000i,1.82818998569327 + 0.00857570493282339i;2.12000000000000e-07 + 0.00000000000000i,1.83924377791490 + 0.00858814401651686i;2.13000000000000e-07 + 0.00000000000000i,1.85012135130620 + 0.00860023710563798i;2.14000000000000e-07 + 0.00000000000000i,1.86083054115192 + 0.00861195664736370i;2.15000000000000e-07 + 0.00000000000000i,1.87137374712621 + 0.00862344402050857i;2.16000000000000e-07 + 0.00000000000000i,1.88175630841468 + 0.00863459513772974i;2.17000000000000e-07 + 0.00000000000000i,1.89198364573170 + 0.00864555743520222i;2.18000000000000e-07 + 0.00000000000000i,1.90205735767870 + 0.00865619448968547i;2.19000000000000e-07 + 0.00000000000000i,1.91198212990083 + 0.00866652046970517i;2.20000000000000e-07 + 0.00000000000000i,1.92175915470438 + 0.00867659910722538i;2.21000000000000e-07 + 0.00000000000000i,1.93139492155087 + 0.00868646559649331i;2.22000000000000e-07 + 0.00000000000000i,1.94089218068756 + 0.00869603092270585i;2.23000000000000e-07 + 0.00000000000000i,1.95025134155452 + 0.00870534348741408i;2.24000000000000e-07 + 0.00000000000000i,1.95948089276504 + 0.00871446511781565i;2.25000000000000e-07 + 0.00000000000000i,1.96857681208373 + 0.00872332415261153i;2.26000000000000e-07 + 0.00000000000000i,1.97754961109585 + 0.00873205097374899i;2.27000000000000e-07 + 0.00000000000000i,1.98639565777613 + 0.00874053927173997i;2.28000000000000e-07 + 0.00000000000000i,1.99512223901070 + 0.00874883472042235i;2.29000000000000e-07 + 0.00000000000000i,2.00372652439615 + 0.00875689030135336i;2.30000000000000e-07 + 0.00000000000000i,2.01221747392153 + 0.00876478190859589i;2.31000000000000e-07 + 0.00000000000000i,2.02059317496427 + 0.00877246484480563i;2.32000000000000e-07 + 0.00000000000000i,2.02885556057619 + 0.00877987812524299i;2.33000000000000e-07 + 0.00000000000000i,2.03701110575712 + 0.00878732785361021i;2.34000000000000e-07 + 0.00000000000000i,2.04505894813698 + 0.00879440915710420i;2.35000000000000e-07 + 0.00000000000000i,2.05300230235195 + 0.00880135554510960i;2.36000000000000e-07 + 0.00000000000000i,2.06084311820500 + 0.00880821570403474i;2.37000000000000e-07 + 0.00000000000000i,2.06858320371459 + 0.00881486847944450i;2.38000000000000e-07 + 0.00000000000000i,2.07622450124081 + 0.00882135427291123i;2.39000000000000e-07 + 0.00000000000000i,2.08376738732295 + 0.00882766811141347i;2.40000000000000e-07 + 0.00000000000000i,2.09121830617075 + 0.00883388518019630i;2.41000000000000e-07 + 0.00000000000000i,2.09857283082294 + 0.00883987276480566i;2.42000000000000e-07 + 0.00000000000000i,2.10583940256512 + 0.00884579496637650i;2.43000000000000e-07 + 0.00000000000000i,2.11301412782535 + 0.00885152679967354i;2.44000000000000e-07 + 0.00000000000000i,2.12010132249592 + 0.00885715493721953i;2.45000000000000e-07 + 0.00000000000000i,2.12710348911997 + 0.00886264706679882i;2.46000000000000e-07 + 0.00000000000000i,2.13401979919010 + 0.00886797490561465i;2.47000000000000e-07 + 0.00000000000000i,2.14085262281765 + 0.00887319716057970i;2.48000000000000e-07 + 0.00000000000000i,2.14760452406449 + 0.00887830304588229i;2.49000000000000e-07 + 0.00000000000000i,2.15427643056402 + 0.00888330283847194i;2.50000000000000e-07 + 0.00000000000000i,2.16086842830489 + 0.00888816363181603i;2.51000000000000e-07 + 0.00000000000000i,2.16738358820014 + 0.00889291753438500i;2.52000000000000e-07 + 0.00000000000000i,2.17382335617223 + 0.00889756595401032i;2.53000000000000e-07 + 0.00000000000000i,2.18018799739290 + 0.00890209427481632i;2.54000000000000e-07 + 0.00000000000000i,2.18647877382655 + 0.00890651101557712i;2.55000000000000e-07 + 0.00000000000000i,2.19269796836981 + 0.00891081529205197i;2.56000000000000e-07 + 0.00000000000000i,2.19884705490607 + 0.00891505287165076i;2.57000000000000e-07 + 0.00000000000000i,2.20492546571492 + 0.00891918210975960i;2.58000000000000e-07 + 0.00000000000000i,2.21093553723742 + 0.00892317448957011i;2.59000000000000e-07 + 0.00000000000000i,2.21687814202945 + 0.00892712180169979i;2.60000000000000e-07 + 0.00000000000000i,2.22275543353093 + 0.00893095064616798i;2.61000000000000e-07 + 0.00000000000000i,2.22856606894534 + 0.00893469562952378i;2.62000000000000e-07 + 0.00000000000000i,2.23431367315556 + 0.00893834861936130i;2.63000000000000e-07 + 0.00000000000000i,2.23999613691009 + 0.00894191351125867i;2.64000000000000e-07 + 0.00000000000000i,2.24561980234727 + 0.00894535888846971i;2.65000000000000e-07 + 0.00000000000000i,2.25118066880956 + 0.00894876346571677i;2.66000000000000e-07 + 0.00000000000000i,2.25668209825694 + 0.00895206707168937i;2.67000000000000e-07 + 0.00000000000000i,2.26212425610602 + 0.00895531967734781i;2.68000000000000e-07 + 0.00000000000000i,2.26750822076682 + 0.00895846967731056i;2.69000000000000e-07 + 0.00000000000000i,2.27283454540711 + 0.00896155178593995i;2.70000000000000e-07 + 0.00000000000000i,2.27810561348617 + 0.00896457763263891i;2.71000000000000e-07 + 0.00000000000000i,2.28332039846097 + 0.00896747637189889i;2.72000000000000e-07 + 0.00000000000000i,2.28848110495083 + 0.00897036521676358i;2.73000000000000e-07 + 0.00000000000000i,2.29358769788615 + 0.00897314736810763i;2.74000000000000e-07 + 0.00000000000000i,2.29864121943272 + 0.00897586408693617i;2.75000000000000e-07 + 0.00000000000000i,2.30364223994965 + 0.00897850922541943i;2.76000000000000e-07 + 0.00000000000000i,2.30859193298637 + 0.00898112567940488i;2.77000000000000e-07 + 0.00000000000000i,2.31349099696350 + 0.00898363216985072i;2.78000000000000e-07 + 0.00000000000000i,2.31834102027249 + 0.00898608979470556i;2.79000000000000e-07 + 0.00000000000000i,2.32314193557528 + 0.00898850535405971i;2.80000000000000e-07 + 0.00000000000000i,2.32789332734198 + 0.00899083351362853i;2.81000000000000e-07 + 0.00000000000000i,2.33259802163102 + 0.00899312561656567i;2.82000000000000e-07 + 0.00000000000000i,2.33725472231317 + 0.00899533802794625i;2.83000000000000e-07 + 0.00000000000000i,2.34186545375384 + 0.00899752997707505i;2.84000000000000e-07 + 0.00000000000000i,2.34643113436940 + 0.00899961400418829i;2.85000000000000e-07 + 0.00000000000000i,2.35095155133185 + 0.00900167387302046i;2.86000000000000e-07 + 0.00000000000000i,2.35542757473052 + 0.00900368446995316i;2.87000000000000e-07 + 0.00000000000000i,2.35985912775859 + 0.00900563060086732i;2.88000000000000e-07 + 0.00000000000000i,2.36424850942749 + 0.00900756108954355i;2.89000000000000e-07 + 0.00000000000000i,2.36859514557244 + 0.00900939383915075i;2.90000000000000e-07 + 0.00000000000000i,2.37289913394525 + 0.00901119617820817i;2.91000000000000e-07 + 0.00000000000000i,2.37716181882909 + 0.00901294703300517i;2.92000000000000e-07 + 0.00000000000000i,2.38138457701422 + 0.00901467312903549i;2.93000000000000e-07 + 0.00000000000000i,2.38556682056070 + 0.00901633620410306i;2.94000000000000e-07 + 0.00000000000000i,2.38970881931127 + 0.00901793367164604i;2.95000000000000e-07 + 0.00000000000000i,2.39381265557099 + 0.00901952862096500i;2.96000000000000e-07 + 0.00000000000000i,2.39787746289155 + 0.00902106051839555i;2.97000000000000e-07 + 0.00000000000000i,2.40190403649570 + 0.00902253492852408i;2.98000000000000e-07 + 0.00000000000000i,2.40589321540448 + 0.00902397837253717i;2.99000000000000e-07 + 0.00000000000000i,2.40984539738525 + 0.00902539475867860i;3.00000000000000e-07 + 0.00000000000000i,2.41376100648791 + 0.00902676227557836i;3.01000000000000e-07 + 0.00000000000000i,2.41763979807224 + 0.00902808410865729i;3.02000000000000e-07 + 0.00000000000000i,2.42148380226319 + 0.00902937748494781i;3.03000000000000e-07 + 0.00000000000000i,2.42529243142666 + 0.00903060763268475i;3.04000000000000e-07 + 0.00000000000000i,2.42906648512640 + 0.00903182963783213i;3.05000000000000e-07 + 0.00000000000000i,2.43280640276790 + 0.00903298005854751i;3.06000000000000e-07 + 0.00000000000000i,2.43651232870490 + 0.00903412851314675i;3.07000000000000e-07 + 0.00000000000000i,2.44018485227343 + 0.00903525779252021i;3.08000000000000e-07 + 0.00000000000000i,2.44382479985054 + 0.00903633159374422i;3.09000000000000e-07 + 0.00000000000000i,2.44743119695330 + 0.00903736683291307i;3.10000000000000e-07 + 0.00000000000000i,2.45100618116942 + 0.00903837669722638i;3.11000000000000e-07 + 0.00000000000000i,2.45454882368661 + 0.00903931762550617i;3.12000000000000e-07 + 0.00000000000000i,2.45806137731743 + 0.00904027315118363i;3.13000000000000e-07 + 0.00000000000000i,2.46154251081361 + 0.00904120736689790i;3.14000000000000e-07 + 0.00000000000000i,2.46499312367167 + 0.00904208739097344i;3.15000000000000e-07 + 0.00000000000000i,2.46841329305433 + 0.00904295133835532i;3.16000000000000e-07 + 0.00000000000000i,2.47180362149583 + 0.00904377270528378i;3.17000000000000e-07 + 0.00000000000000i,2.47516479465841 + 0.00904457223084946i;3.18000000000000e-07 + 0.00000000000000i,2.47849706923368 + 0.00904533568481846i;3.19000000000000e-07 + 0.00000000000000i,2.48180005412665 + 0.00904609019798189i;3.20000000000000e-07 + 0.00000000000000i,2.48507484701321 + 0.00904678984760026i;3.21000000000000e-07 + 0.00000000000000i,2.48832178052584 + 0.00904747328741065i;3.22000000000000e-07 + 0.00000000000000i,2.49154153559613 + 0.00904815482306801i;3.23000000000000e-07 + 0.00000000000000i,2.49473380835646 + 0.00904878944448994i;3.24000000000000e-07 + 0.00000000000000i,2.49789886744509 + 0.00904938729902630i;3.25000000000000e-07 + 0.00000000000000i,2.50103650630156 + 0.00904994263148542i;3.26000000000000e-07 + 0.00000000000000i,2.50414918450600 + 0.00905054519513777i;3.27000000000000e-07 + 0.00000000000000i,2.50723514602732 + 0.00905108528898011i;3.28000000000000e-07 + 0.00000000000000i,2.51029502453578 + 0.00905158841468276i;3.29000000000000e-07 + 0.00000000000000i,2.51332916087267 + 0.00905206894026370i;3.30000000000000e-07 + 0.00000000000000i,2.51633956150586 + 0.00905255028640816i;3.31000000000000e-07 + 0.00000000000000i,2.51932438168064 + 0.00905301717934015i;3.32000000000000e-07 + 0.00000000000000i,2.52228461517272 + 0.00905344040750750i;3.33000000000000e-07 + 0.00000000000000i,2.52522024525309 + 0.00905384244754561i;3.34000000000000e-07 + 0.00000000000000i,2.52813227519475 + 0.00905424071108561i;3.35000000000000e-07 + 0.00000000000000i,2.53102061863092 + 0.00905460633604219i;3.36000000000000e-07 + 0.00000000000000i,2.53388511631172 + 0.00905495521837365i;3.37000000000000e-07 + 0.00000000000000i,2.53672609387333 + 0.00905527289160107i;3.38000000000000e-07 + 0.00000000000000i,2.53954478627639 + 0.00905559270885161i;3.39000000000000e-07 + 0.00000000000000i,2.54234038296889 + 0.00905589943107577i;3.40000000000000e-07 + 0.00000000000000i,2.54511381507075 + 0.00905617057482893i;3.41000000000000e-07 + 0.00000000000000i,2.54786480518355 + 0.00905642473216877i;3.42000000000000e-07 + 0.00000000000000i,2.55059436266207 + 0.00905665981793491i;3.43000000000000e-07 + 0.00000000000000i,2.55330219460534 + 0.00905689346748102i;3.44000000000000e-07 + 0.00000000000000i,2.55598834620314 + 0.00905709010927876i;3.45000000000000e-07 + 0.00000000000000i,2.55865334583494 + 0.00905725398582399i;3.46000000000000e-07 + 0.00000000000000i,2.56129775516050 + 0.00905743091228529i;3.47000000000000e-07 + 0.00000000000000i,2.56392094925625 + 0.00905758248103160i;3.48000000000000e-07 + 0.00000000000000i,2.56652417521116 + 0.00905773740168044i;3.49000000000000e-07 + 0.00000000000000i,2.56910659423447 + 0.00905785609339384i;3.50000000000000e-07 + 0.00000000000000i,2.57166918659272 + 0.00905796465716413i;3.51000000000000e-07 + 0.00000000000000i,2.57421168466143 + 0.00905805745433553i;3.52000000000000e-07 + 0.00000000000000i,2.57673450754053 + 0.00905813124118313i;3.53000000000000e-07 + 0.00000000000000i,2.57923817829796 + 0.00905819677142928i;3.54000000000000e-07 + 0.00000000000000i,2.58172260838380 + 0.00905825310015836i;3.55000000000000e-07 + 0.00000000000000i,2.58418765857558 + 0.00905828787972552i;3.56000000000000e-07 + 0.00000000000000i,2.58663475694670 + 0.00905832854682168i;3.57000000000000e-07 + 0.00000000000000i,2.58906264958835 + 0.00905833312329211i;3.58000000000000e-07 + 0.00000000000000i,2.59147222161427 + 0.00905833435931500i;3.59000000000000e-07 + 0.00000000000000i,2.59386346775298 + 0.00905832262673915i;3.60000000000000e-07 + 0.00000000000000i,2.59623662619959 + 0.00905830082586867i;3.61000000000000e-07 + 0.00000000000000i,2.59859253440944 + 0.00905825260551738i;3.62000000000000e-07 + 0.00000000000000i,2.60093039856518 + 0.00905820693598010i;3.63000000000000e-07 + 0.00000000000000i,2.60325040541850 + 0.00905815127408726i;3.64000000000000e-07 + 0.00000000000000i,2.60555353554503 + 0.00905807966122777i;3.65000000000000e-07 + 0.00000000000000i,2.60783968865687 + 0.00905798445370605i;3.66000000000000e-07 + 0.00000000000000i,2.61010877517611 + 0.00905789406945328i;3.67000000000000e-07 + 0.00000000000000i,2.61236084458441 + 0.00905777509676017i;3.68000000000000e-07 + 0.00000000000000i,2.61459686660479 + 0.00905766655819168i;3.69000000000000e-07 + 0.00000000000000i,2.61681587418724 + 0.00905754463766809i;3.70000000000000e-07 + 0.00000000000000i,2.61901922213935 + 0.00905740273265353i;3.71000000000000e-07 + 0.00000000000000i,2.62120581404562 + 0.00905724894386517i;3.72000000000000e-07 + 0.00000000000000i,2.62337666370801 + 0.00905708317872466i;3.73000000000000e-07 + 0.00000000000000i,2.62553207475912 + 0.00905692466219188i;3.74000000000000e-07 + 0.00000000000000i,2.62767163817459 + 0.00905675439741173i;3.75000000000000e-07 + 0.00000000000000i,2.62979599460929 + 0.00905657836358514i;3.76000000000000e-07 + 0.00000000000000i,2.63190452287420 + 0.00905637362038108i;3.77000000000000e-07 + 0.00000000000000i,2.63399841927634 + 0.00905615991974474i;3.78000000000000e-07 + 0.00000000000000i,2.63607746377003 + 0.00905596246487364i;3.79000000000000e-07 + 0.00000000000000i,2.63814121648644 + 0.00905573422435075i;3.80000000000000e-07 + 0.00000000000000i,2.64019049009609 + 0.00905550673296838i;3.81000000000000e-07 + 0.00000000000000i,2.64222539133145 + 0.00905527542721873i;3.82000000000000e-07 + 0.00000000000000i,2.64424579389677 + 0.00905503377593943i;3.83000000000000e-07 + 0.00000000000000i,2.64625174897707 + 0.00905477445334633i;3.84000000000000e-07 + 0.00000000000000i,2.64824377087488 + 0.00905450889086704i;3.85000000000000e-07 + 0.00000000000000i,2.65022181252950 + 0.00905423908654282i;3.86000000000000e-07 + 0.00000000000000i,2.65218576174083 + 0.00905395904636849i;3.87000000000000e-07 + 0.00000000000000i,2.65413582976019 + 0.00905366766879413i;3.88000000000000e-07 + 0.00000000000000i,2.65607279726497 + 0.00905337886303829i;3.89000000000000e-07 + 0.00000000000000i,2.65799631939152 + 0.00905308889483487i;3.90000000000000e-07 + 0.00000000000000i,2.65990609448388 + 0.00905278061274626i;3.91000000000000e-07 + 0.00000000000000i,2.66180274993369 + 0.00905246563966604i;3.92000000000000e-07 + 0.00000000000000i,2.66368660943640 + 0.00905215057879252i;3.93000000000000e-07 + 0.00000000000000i,2.66555694594634 + 0.00905182348547057i;3.94000000000000e-07 + 0.00000000000000i,2.66741472725206 + 0.00905149257229711i;3.95000000000000e-07 + 0.00000000000000i,2.66926007159014 + 0.00905116501750356i;3.96000000000000e-07 + 0.00000000000000i,2.67109297378706 + 0.00905081457899295i;3.97000000000000e-07 + 0.00000000000000i,2.67291296428855 + 0.00905047016479181i;3.98000000000000e-07 + 0.00000000000000i,2.67472077216841 + 0.00905010831426138i;3.99000000000000e-07 + 0.00000000000000i,2.67651652092137 + 0.00904975091459801i;4.00000000000000e-07 + 0.00000000000000i,2.67829957284805 + 0.00904938172315388i];
d = Data(:,1);neff = (Data(:,2));perm = neff.^2;

figure;
yyaxis right;
plot(d*1e9,abs(real(perm)));
set(gcf, 'Position', [00, 00, 400, 300]);
ylabel('Real permittivity');
xlabel('Waveguide width');
yyaxis left;
hold on;
plot(d*1e9,imag(perm));
ylabel('Imaginary permittivity');
xlabel('Waveguide width');
legend(["Imaginary permittivity","Real permittivity"]);
title('100nm InP Left');
xlim([130 400]);

k0 = 2*pi/1550e-5;
L = 20e-6;
M = 300;
ne = 2.6;
z = -L/2:(L/(M - 1)):L/2;
wz = 2*ne*z/L;
permz = wz.^2;
figure;
plot(z,permz);

for ind = 1:1:M
    [~,inx] = min(abs((real(permz(ind) - perm)))); 
    d_Al(ind) = d(inx); 
    eps(ind) = perm(inx); 
end

figure;
yyaxis left;
plot(z*1e6,real(eps));
set(gcf, 'Position', [00, 00, 400, 300]);
xlabel('x(\mum)');
ylabel('Re[\epsilon]');
yyaxis right
plot(z*1e6,imag(eps));
set(gcf, 'Position', [00, 00, 400, 300]);
xlabel('x(\mum)');
ylabel('Im[\epsilon]');

figure;
plot(z*1e6,d_Al*1e9);
set(gcf, 'Position', [00, 00, 400, 300]);
xlabel('x(\mum)');
ylabel('Waveguide width(nm)')

figure;
plot(z,imag(eps))

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%For Comsol Geometry
% a = 0.181/0.161 - 1;
a = 0.161/0.161 - 1;
gc = -a*(abs(2*z/L)).^2 + a + 1;
Al_Y = [d_Al.*gc*1e6 -d_Al.*gc*1e6]/2;
Al_Y_h = Al_Y';
Al_Z = [z -z]*1e6;
Al_Z_h = Al_Z';
% Al_Y = [d_Al-0.0e-6 -d_Al+0.0e-6]/2*1e6;Al_Z = [z -z]*1e6;
% PumpSweep = unique(Lx_Al_Com)*1e9;
SiO_Y = [d_Al + 60e-9 -d_Al - 60e-9]/2*1e6;
SiO_Z = [z -z];


% % %%%%3.3^2 +(0.03*exp(-((z-5.168[um])/2[um])^2) + 0.03*exp(-((z+5.168[um])/2[um])^2) + 0.017*exp(-(z/10[um])^2))*i
% % tm = 0.03*exp(-((z-5.168e-6)/2e-6).^2) + 0.03*exp(-((z+5.168e-6)/2e-6).^2) + 0.017*exp(-(z/10e-6).^2);
% % figure
% % plot(z,tm)