clc
clear all
% close all

% Htop = 3*Ht
Data = [1.60000000000000e-07 + 0.00000000000000i,0.0413770327854904 + 0.177585220753776i;1.61000000000000e-07 + 0.00000000000000i,0.0924475076473850 + 0.0789039976305115i;1.62000000000000e-07 + 0.00000000000000i,0.188650711650217 + 0.0383875173891357i;1.63000000000000e-07 + 0.00000000000000i,0.257555913790431 + 0.0279152896513856i;1.64000000000000e-07 + 0.00000000000000i,0.311767140021482 + 0.0228971338559739i;1.65000000000000e-07 + 0.00000000000000i,0.357538756035149 + 0.0198244057027312i;1.66000000000000e-07 + 0.00000000000000i,0.397739719779664 + 0.0176954595178158i;1.67000000000000e-07 + 0.00000000000000i,0.433902574038353 + 0.0161077944138732i;1.68000000000000e-07 + 0.00000000000000i,0.466948408735116 + 0.0148642815774075i;1.69000000000000e-07 + 0.00000000000000i,0.497507203490621 + 0.0138556014003875i;1.70000000000000e-07 + 0.00000000000000i,0.526004032026287 + 0.0130154567582986i;1.71000000000000e-07 + 0.00000000000000i,0.552763217846923 + 0.0123011613796549i;1.72000000000000e-07 + 0.00000000000000i,0.578039379245335 + 0.0116840391771910i;1.73000000000000e-07 + 0.00000000000000i,0.602013748159564 + 0.0111434857981096i;1.74000000000000e-07 + 0.00000000000000i,0.624839203390469 + 0.0106646469164790i;1.75000000000000e-07 + 0.00000000000000i,0.646643434135822 + 0.0102364738176192i;1.76000000000000e-07 + 0.00000000000000i,0.667533660854619 + 0.00985057366426703i;1.77000000000000e-07 + 0.00000000000000i,0.687584855523975 + 0.00949999051913476i;1.78000000000000e-07 + 0.00000000000000i,0.706879160043859 + 0.00917968796891579i;1.79000000000000e-07 + 0.00000000000000i,0.725486047910241 + 0.00888552519088031i;1.80000000000000e-07 + 0.00000000000000i,0.743445806648884 + 0.00861380973755021i;1.81000000000000e-07 + 0.00000000000000i,0.760820139993201 + 0.00836199105906861i;1.82000000000000e-07 + 0.00000000000000i,0.777642510258803 + 0.00812758622260730i;1.83000000000000e-07 + 0.00000000000000i,0.793950768132214 + 0.00790872191982103i;1.84000000000000e-07 + 0.00000000000000i,0.809785224011966 + 0.00770399341308400i;1.85000000000000e-07 + 0.00000000000000i,0.825161897636037 + 0.00751187154585431i;1.86000000000000e-07 + 0.00000000000000i,0.840121968447351 + 0.00733168465061169i;1.87000000000000e-07 + 0.00000000000000i,0.854687763953927 + 0.00716256979838129i;1.88000000000000e-07 + 0.00000000000000i,0.868876304610060 + 0.00700366246002575i;1.89000000000000e-07 + 0.00000000000000i,0.882712920691790 + 0.00685444401838945i;1.90000000000000e-07 + 0.00000000000000i,0.896202415671383 + 0.00671386649874416i;1.91000000000000e-07 + 0.00000000000000i,0.909380180953050 + 0.00658170868030831i;1.92000000000000e-07 + 0.00000000000000i,0.922248489423204 + 0.00645689575709448i;1.93000000000000e-07 + 0.00000000000000i,0.934821522530342 + 0.00633867642752292i;1.94000000000000e-07 + 0.00000000000000i,0.947118512782987 + 0.00622653361097226i;1.95000000000000e-07 + 0.00000000000000i,0.959149731751282 + 0.00611979166318444i;1.96000000000000e-07 + 0.00000000000000i,0.970929283532819 + 0.00601795877779360i;1.97000000000000e-07 + 0.00000000000000i,0.982457718983171 + 0.00592033113702170i;1.98000000000000e-07 + 0.00000000000000i,0.993753389328741 + 0.00582674929421662i;1.99000000000000e-07 + 0.00000000000000i,1.00482971556379 + 0.00573700541824619i;2.00000000000000e-07 + 0.00000000000000i,1.01568610234067 + 0.00565060201616708i;2.01000000000000e-07 + 0.00000000000000i,1.02633373006497 + 0.00556737417472357i;2.02000000000000e-07 + 0.00000000000000i,1.03678257355903 + 0.00548718812067841i;2.03000000000000e-07 + 0.00000000000000i,1.04704138341591 + 0.00540993954297778i;2.04000000000000e-07 + 0.00000000000000i,1.05710528664727 + 0.00533521382354568i;2.05000000000000e-07 + 0.00000000000000i,1.06699815342812 + 0.00526319088706535i;2.06000000000000e-07 + 0.00000000000000i,1.07671589564488 + 0.00519355714098447i;2.07000000000000e-07 + 0.00000000000000i,1.08626733499729 + 0.00512626011276730i;2.08000000000000e-07 + 0.00000000000000i,1.09565600740473 + 0.00506117298163217i;2.09000000000000e-07 + 0.00000000000000i,1.10488589744109 + 0.00499812093061474i;2.10000000000000e-07 + 0.00000000000000i,1.11396734310273 + 0.00493718885462075i;2.11000000000000e-07 + 0.00000000000000i,1.12290260878774 + 0.00487819813861431i;2.12000000000000e-07 + 0.00000000000000i,1.13169017646155 + 0.00482091194627389i;2.13000000000000e-07 + 0.00000000000000i,1.14034289562638 + 0.00476547802025379i;2.14000000000000e-07 + 0.00000000000000i,1.14886035303701 + 0.00471172170165656i;2.15000000000000e-07 + 0.00000000000000i,1.15724713943932 + 0.00465956562481157i;2.16000000000000e-07 + 0.00000000000000i,1.16550866619522 + 0.00460902034065438i;2.17000000000000e-07 + 0.00000000000000i,1.17364366818003 + 0.00455987604456163i;2.18000000000000e-07 + 0.00000000000000i,1.18165975450470 + 0.00451217332201522i;2.19000000000000e-07 + 0.00000000000000i,1.18956343041049 + 0.00446597863542729i;2.20000000000000e-07 + 0.00000000000000i,1.19734914254199 + 0.00442096889189039i;2.21000000000000e-07 + 0.00000000000000i,1.20502464994485 + 0.00437723800464179i;2.22000000000000e-07 + 0.00000000000000i,1.21259435243966 + 0.00433479861923572i;2.23000000000000e-07 + 0.00000000000000i,1.22006008423678 + 0.00429355034106561i;2.24000000000000e-07 + 0.00000000000000i,1.22742265830058 + 0.00425342391869551i;2.25000000000000e-07 + 0.00000000000000i,1.23467791614028 + 0.00421428072292945i;2.26000000000000e-07 + 0.00000000000000i,1.24184087390057 + 0.00417623312460099i;2.27000000000000e-07 + 0.00000000000000i,1.24890937415391 + 0.00413922041952429i;2.28000000000000e-07 + 0.00000000000000i,1.25588870543690 + 0.00410329583988939i;2.29000000000000e-07 + 0.00000000000000i,1.26277396135687 + 0.00406819990147993i;2.30000000000000e-07 + 0.00000000000000i,1.26957137591059 + 0.00403405866869374i;2.31000000000000e-07 + 0.00000000000000i,1.27628377170411 + 0.00400083988758383i;2.32000000000000e-07 + 0.00000000000000i,1.28291219792724 + 0.00396849628625782i;2.33000000000000e-07 + 0.00000000000000i,1.28945627540546 + 0.00393692849743660i;2.34000000000000e-07 + 0.00000000000000i,1.29592137599601 + 0.00390620848529693i;2.35000000000000e-07 + 0.00000000000000i,1.30230793142034 + 0.00387628901083659i;2.36000000000000e-07 + 0.00000000000000i,1.30861641015928 + 0.00384709778995512i;2.37000000000000e-07 + 0.00000000000000i,1.31484655002798 + 0.00381856986744303i;2.38000000000000e-07 + 0.00000000000000i,1.32100530733445 + 0.00379081049963974i;2.39000000000000e-07 + 0.00000000000000i,1.32709217014941 + 0.00376376259670544i;2.40000000000000e-07 + 0.00000000000000i,1.33310927564061 + 0.00373741103985047i;2.41000000000000e-07 + 0.00000000000000i,1.33905553831676 + 0.00371168213371399i;2.42000000000000e-07 + 0.00000000000000i,1.34493243996490 + 0.00368652685579001i;2.43000000000000e-07 + 0.00000000000000i,1.35074388098613 + 0.00366202598686264i;2.44000000000000e-07 + 0.00000000000000i,1.35648439468369 + 0.00363809755553989i;2.45000000000000e-07 + 0.00000000000000i,1.36216724635302 + 0.00361477074130963i;2.46000000000000e-07 + 0.00000000000000i,1.36778583868079 + 0.00359199473183146i;2.47000000000000e-07 + 0.00000000000000i,1.37334138170704 + 0.00356974070550480i;2.48000000000000e-07 + 0.00000000000000i,1.37884026001343 + 0.00354810637000791i;2.49000000000000e-07 + 0.00000000000000i,1.38427786520378 + 0.00352693526885256i;2.50000000000000e-07 + 0.00000000000000i,1.38965711803451 + 0.00350625686014073i;2.51000000000000e-07 + 0.00000000000000i,1.39497888122469 + 0.00348607502332342i;2.52000000000000e-07 + 0.00000000000000i,1.40024594857877 + 0.00346639621552727i;2.53000000000000e-07 + 0.00000000000000i,1.40545761458689 + 0.00344717566416672i;2.54000000000000e-07 + 0.00000000000000i,1.41061707323798 + 0.00342846122952217i;2.55000000000000e-07 + 0.00000000000000i,1.41572084377941 + 0.00341012503546503i;2.56000000000000e-07 + 0.00000000000000i,1.42077113477485 + 0.00339218901142437i;2.57000000000000e-07 + 0.00000000000000i,1.42577406599061 + 0.00337477084905441i;2.58000000000000e-07 + 0.00000000000000i,1.43072385159858 + 0.00335767687564360i;2.59000000000000e-07 + 0.00000000000000i,1.43562467173930 + 0.00334100181941980i;2.60000000000000e-07 + 0.00000000000000i,1.44047974052307 + 0.00332480870400094i;2.61000000000000e-07 + 0.00000000000000i,1.44528379684972 + 0.00330889057234267i;2.62000000000000e-07 + 0.00000000000000i,1.45004194474248 + 0.00329338456987545i;2.63000000000000e-07 + 0.00000000000000i,1.45475651442162 + 0.00327831607203129i;2.64000000000000e-07 + 0.00000000000000i,1.45942065408073 + 0.00326345367395244i;2.65000000000000e-07 + 0.00000000000000i,1.46403801895328 + 0.00324901417065482i;2.66000000000000e-07 + 0.00000000000000i,1.46861548991086 + 0.00323489673049815i;2.67000000000000e-07 + 0.00000000000000i,1.47314963619396 + 0.00322111689788172i;2.68000000000000e-07 + 0.00000000000000i,1.47764439751378 + 0.00320774844601809i;2.69000000000000e-07 + 0.00000000000000i,1.48209244619017 + 0.00319455389083229i;2.70000000000000e-07 + 0.00000000000000i,1.48650280776586 + 0.00318176201187001i;2.71000000000000e-07 + 0.00000000000000i,1.49087159907266 + 0.00316928777955695i;2.72000000000000e-07 + 0.00000000000000i,1.49519966822660 + 0.00315705348835331i;2.73000000000000e-07 + 0.00000000000000i,1.49949150861633 + 0.00314520022043142i;2.74000000000000e-07 + 0.00000000000000i,1.50374113946564 + 0.00313352428429367i;2.75000000000000e-07 + 0.00000000000000i,1.50795448666354 + 0.00312218884799245i;2.76000000000000e-07 + 0.00000000000000i,1.51212800417620 + 0.00311106325380832i;2.77000000000000e-07 + 0.00000000000000i,1.51626710317791 + 0.00310027937860244i;2.78000000000000e-07 + 0.00000000000000i,1.52036938040428 + 0.00308973996280103i;2.79000000000000e-07 + 0.00000000000000i,1.52443370044202 + 0.00307939558307990i;2.80000000000000e-07 + 0.00000000000000i,1.52846594887520 + 0.00306940305831453i;2.81000000000000e-07 + 0.00000000000000i,1.53246113036773 + 0.00305957582406741i;2.82000000000000e-07 + 0.00000000000000i,1.53642214126155 + 0.00304999632721420i;2.83000000000000e-07 + 0.00000000000000i,1.54035151415760 + 0.00304073284816096i;2.84000000000000e-07 + 0.00000000000000i,1.54423887656689 + 0.00303154322776389i;2.85000000000000e-07 + 0.00000000000000i,1.54810036071567 + 0.00302269030950079i;2.86000000000000e-07 + 0.00000000000000i,1.55193016792267 + 0.00301405952404145i;2.87000000000000e-07 + 0.00000000000000i,1.55572653230115 + 0.00300563242940939i;2.88000000000000e-07 + 0.00000000000000i,1.55949302740651 + 0.00299745005612394i;2.89000000000000e-07 + 0.00000000000000i,1.56322706009544 + 0.00298942495186005i;2.90000000000000e-07 + 0.00000000000000i,1.56693101211038 + 0.00298163337501531i;2.91000000000000e-07 + 0.00000000000000i,1.57060344068903 + 0.00297401399306459i;2.92000000000000e-07 + 0.00000000000000i,1.57424872472390 + 0.00296665243580459i;2.93000000000000e-07 + 0.00000000000000i,1.57786289987202 + 0.00295943765985151i;2.94000000000000e-07 + 0.00000000000000i,1.58144738644419 + 0.00295241146931924i;2.95000000000000e-07 + 0.00000000000000i,1.58500421293135 + 0.00294558916000218i;2.96000000000000e-07 + 0.00000000000000i,1.58853155925658 + 0.00293891760879997i;2.97000000000000e-07 + 0.00000000000000i,1.59203185369783 + 0.00293245885717833i;2.98000000000000e-07 + 0.00000000000000i,1.59550581780255 + 0.00292619089126862i;2.99000000000000e-07 + 0.00000000000000i,1.59895027732111 + 0.00292004044902909i;3.00000000000000e-07 + 0.00000000000000i,1.60236983992293 + 0.00291410920065509i;3.01000000000000e-07 + 0.00000000000000i,1.60576157602348 + 0.00290831245418605i;3.02000000000000e-07 + 0.00000000000000i,1.60912786056062 + 0.00290268629781751i;3.03000000000000e-07 + 0.00000000000000i,1.61247022512826 + 0.00289728994586278i;3.04000000000000e-07 + 0.00000000000000i,1.61578514203961 + 0.00289198598581395i;3.05000000000000e-07 + 0.00000000000000i,1.61906746617691 + 0.00288674654901297i;3.06000000000000e-07 + 0.00000000000000i,1.62233326829245 + 0.00288178730334206i;3.07000000000000e-07 + 0.00000000000000i,1.62557369147830 + 0.00287694913832693i;3.08000000000000e-07 + 0.00000000000000i,1.62879026922977 + 0.00287224990364254i;3.09000000000000e-07 + 0.00000000000000i,1.63198162605162 + 0.00286769985107066i;3.10000000000000e-07 + 0.00000000000000i,1.63515026566765 + 0.00286328904815069i;3.11000000000000e-07 + 0.00000000000000i,1.63829528636748 + 0.00285902299207298i;3.12000000000000e-07 + 0.00000000000000i,1.64141773275102 + 0.00285488681989480i;3.13000000000000e-07 + 0.00000000000000i,1.64451728618198 + 0.00285090418395101i;3.14000000000000e-07 + 0.00000000000000i,1.64759390253924 + 0.00284704555026723i;3.15000000000000e-07 + 0.00000000000000i,1.65064694738908 + 0.00284327045113892i;3.16000000000000e-07 + 0.00000000000000i,1.65367955673743 + 0.00283968374504813i;3.17000000000000e-07 + 0.00000000000000i,1.65669019882753 + 0.00283620139870559i;3.18000000000000e-07 + 0.00000000000000i,1.65967796705920 + 0.00283280209458918i;3.19000000000000e-07 + 0.00000000000000i,1.66264551474197 + 0.00282956501481658i;3.20000000000000e-07 + 0.00000000000000i,1.66559452053496 + 0.00282651000936062i;3.21000000000000e-07 + 0.00000000000000i,1.66851993813251 + 0.00282348633363771i;3.22000000000000e-07 + 0.00000000000000i,1.67142463508000 + 0.00282058610758529i;3.23000000000000e-07 + 0.00000000000000i,1.67430904030309 + 0.00281779814222296i;3.24000000000000e-07 + 0.00000000000000i,1.67717531357424 + 0.00281516617275510i;3.25000000000000e-07 + 0.00000000000000i,1.68001654993022 + 0.00281262021103493i;3.26000000000000e-07 + 0.00000000000000i,1.68284149075228 + 0.00281016220821305i;3.27000000000000e-07 + 0.00000000000000i,1.68564711707607 + 0.00280781276563333i;3.28000000000000e-07 + 0.00000000000000i,1.68843514111122 + 0.00280559279519679i;3.29000000000000e-07 + 0.00000000000000i,1.69120404110439 + 0.00280350529995482i;3.30000000000000e-07 + 0.00000000000000i,1.69395135646489 + 0.00280142265226398i;3.31000000000000e-07 + 0.00000000000000i,1.69668400370734 + 0.00279955875241717i;3.32000000000000e-07 + 0.00000000000000i,1.69939541499972 + 0.00279769861777603i;3.33000000000000e-07 + 0.00000000000000i,1.70209069455775 + 0.00279600446241370i;3.34000000000000e-07 + 0.00000000000000i,1.70476669120053 + 0.00279436941218985i;3.35000000000000e-07 + 0.00000000000000i,1.70742505906217 + 0.00279284574148269i;3.36000000000000e-07 + 0.00000000000000i,1.71006569960873 + 0.00279139062351357i;3.37000000000000e-07 + 0.00000000000000i,1.71268954459681 + 0.00279005085389967i;3.38000000000000e-07 + 0.00000000000000i,1.71529622446485 + 0.00278878392608493i;3.39000000000000e-07 + 0.00000000000000i,1.71788553669094 + 0.00278761294023273i;3.40000000000000e-07 + 0.00000000000000i,1.72045914074819 + 0.00278656155363989i;3.41000000000000e-07 + 0.00000000000000i,1.72301365409876 + 0.00278551433554385i;3.42000000000000e-07 + 0.00000000000000i,1.72555480335751 + 0.00278465933043798i;3.43000000000000e-07 + 0.00000000000000i,1.72807828072219 + 0.00278383021703371i;3.44000000000000e-07 + 0.00000000000000i,1.73058581834244 + 0.00278309558275392i;3.45000000000000e-07 + 0.00000000000000i,1.73307024756094 + 0.00278235426994810i;3.46000000000000e-07 + 0.00000000000000i,1.73554658959063 + 0.00278179744423588i;3.47000000000000e-07 + 0.00000000000000i,1.73800658260023 + 0.00278129526499791i;3.48000000000000e-07 + 0.00000000000000i,1.74045096528757 + 0.00278088589889045i;3.49000000000000e-07 + 0.00000000000000i,1.74287958241909 + 0.00278053498118044i;3.50000000000000e-07 + 0.00000000000000i,1.74529354774330 + 0.00278027345891941i;3.51000000000000e-07 + 0.00000000000000i,1.74769306074859 + 0.00278010155328426i;3.52000000000000e-07 + 0.00000000000000i,1.75007589225049 + 0.00277994204756198i;3.53000000000000e-07 + 0.00000000000000i,1.75244635304155 + 0.00277993699764992i;3.54000000000000e-07 + 0.00000000000000i,1.75480011125310 + 0.00277993510476301i;3.55000000000000e-07 + 0.00000000000000i,1.75713950892311 + 0.00278001834144520i;3.56000000000000e-07 + 0.00000000000000i,1.75946612030152 + 0.00278020788666985i;3.57000000000000e-07 + 0.00000000000000i,1.76177663648002 + 0.00278040314216734i;3.58000000000000e-07 + 0.00000000000000i,1.76407507954770 + 0.00278072121855433i;3.59000000000000e-07 + 0.00000000000000i,1.76636090469649 + 0.00278114425930303i;3.60000000000000e-07 + 0.00000000000000i,1.76863134470534 + 0.00278159586261650i;3.61000000000000e-07 + 0.00000000000000i,1.77088712128912 + 0.00278207345147678i;3.62000000000000e-07 + 0.00000000000000i,1.77312956556626 + 0.00278263440094418i;3.63000000000000e-07 + 0.00000000000000i,1.77536113455452 + 0.00278329542850794i;3.64000000000000e-07 + 0.00000000000000i,1.77757752630676 + 0.00278398359227652i;3.65000000000000e-07 + 0.00000000000000i,1.77977712842509 + 0.00278473205925531i;3.66000000000000e-07 + 0.00000000000000i,1.78196872101069 + 0.00278557423222484i;3.67000000000000e-07 + 0.00000000000000i,1.78414682913339 + 0.00278646680290070i;3.68000000000000e-07 + 0.00000000000000i,1.78631151412221 + 0.00278740029426669i;3.69000000000000e-07 + 0.00000000000000i,1.78846303843243 + 0.00278836830502427i;3.70000000000000e-07 + 0.00000000000000i,1.79060409282129 + 0.00278946094356182i;3.71000000000000e-07 + 0.00000000000000i,1.79273272227710 + 0.00279060387428659i;3.72000000000000e-07 + 0.00000000000000i,1.79484809484708 + 0.00279176978593164i;3.73000000000000e-07 + 0.00000000000000i,1.79695292879716 + 0.00279304883923106i;3.74000000000000e-07 + 0.00000000000000i,1.79904500860022 + 0.00279434967047321i;3.75000000000000e-07 + 0.00000000000000i,1.80112562104015 + 0.00279572578549359i;3.76000000000000e-07 + 0.00000000000000i,1.80319245870727 + 0.00279711440849710i;3.77000000000000e-07 + 0.00000000000000i,1.80524778377399 + 0.00279854290639934i;3.78000000000000e-07 + 0.00000000000000i,1.80729513481626 + 0.00280012234186760i;3.79000000000000e-07 + 0.00000000000000i,1.80932827724697 + 0.00280167887751952i;3.80000000000000e-07 + 0.00000000000000i,1.81135046640601 + 0.00280332140120918i;3.81000000000000e-07 + 0.00000000000000i,1.81336133592116 + 0.00280499338643801i;3.82000000000000e-07 + 0.00000000000000i,1.81536140911516 + 0.00280673386913221i;3.83000000000000e-07 + 0.00000000000000i,1.81735228068650 + 0.00280856558705125i;3.84000000000000e-07 + 0.00000000000000i,1.81932965807343 + 0.00281039066576641i;3.85000000000000e-07 + 0.00000000000000i,1.82129318030467 + 0.00281224029080904i;3.86000000000000e-07 + 0.00000000000000i,1.82325110063593 + 0.00281421439956127i;3.87000000000000e-07 + 0.00000000000000i,1.82519576624976 + 0.00281617582956074i;3.88000000000000e-07 + 0.00000000000000i,1.82713189187818 + 0.00281824160182878i;3.89000000000000e-07 + 0.00000000000000i,1.82905745423433 + 0.00282033858175959i;3.90000000000000e-07 + 0.00000000000000i,1.83097249365951 + 0.00282247563603673i;3.91000000000000e-07 + 0.00000000000000i,1.83287622620960 + 0.00282464921819192i;3.92000000000000e-07 + 0.00000000000000i,1.83477186423474 + 0.00282691249459916i;3.93000000000000e-07 + 0.00000000000000i,1.83665737487127 + 0.00282922111844269i;3.94000000000000e-07 + 0.00000000000000i,1.83853102979004 + 0.00283152951001535i;3.95000000000000e-07 + 0.00000000000000i,1.84039581419137 + 0.00283392206319368i;3.96000000000000e-07 + 0.00000000000000i,1.84225150034682 + 0.00283635877882795i;3.97000000000000e-07 + 0.00000000000000i,1.84409733898638 + 0.00283884025516213i;3.98000000000000e-07 + 0.00000000000000i,1.84593272861234 + 0.00284135174149116i;3.99000000000000e-07 + 0.00000000000000i,1.84776008389122 + 0.00284394153873191i;4.00000000000000e-07 + 0.00000000000000i,1.84957658888904 + 0.00284654553811326i;4.01000000000000e-07 + 0.00000000000000i,1.85138445601369 + 0.00284921205470202i;4.02000000000000e-07 + 0.00000000000000i,1.85318333997164 + 0.00285191796317317i;4.03000000000000e-07 + 0.00000000000000i,1.85497323058111 + 0.00285468336723493i;4.04000000000000e-07 + 0.00000000000000i,1.85675448327291 + 0.00285749660863747i;4.05000000000000e-07 + 0.00000000000000i,1.85852156190577 + 0.00286029250325967i;4.06000000000000e-07 + 0.00000000000000i,1.86028319998182 + 0.00286315923771323i;4.07000000000000e-07 + 0.00000000000000i,1.86203701747136 + 0.00286608486259556i;4.08000000000000e-07 + 0.00000000000000i,1.86378205027845 + 0.00286906560859760i;4.09000000000000e-07 + 0.00000000000000i,1.86551652092108 + 0.00287202951386774i;4.10000000000000e-07 + 0.00000000000000i,1.86724508463469 + 0.00287510669904302i;4.11000000000000e-07 + 0.00000000000000i,1.86896538835572 + 0.00287824007826290i;4.12000000000000e-07 + 0.00000000000000i,1.87067490806075 + 0.00288135326639435i;4.13000000000000e-07 + 0.00000000000000i,1.87237821014937 + 0.00288456069056156i;4.14000000000000e-07 + 0.00000000000000i,1.87407084336547 + 0.00288775504042786i;4.15000000000000e-07 + 0.00000000000000i,1.87575666054263 + 0.00289101721469265i;4.16000000000000e-07 + 0.00000000000000i,1.87743387907893 + 0.00289430982517355i;4.17000000000000e-07 + 0.00000000000000i,1.87910358624654 + 0.00289765560359536i;4.18000000000000e-07 + 0.00000000000000i,1.88076629859475 + 0.00290107386073789i;4.19000000000000e-07 + 0.00000000000000i,1.88241988764053 + 0.00290450223421918i;4.20000000000000e-07 + 0.00000000000000i,1.88406461376030 + 0.00290794806008616i;4.21000000000000e-07 + 0.00000000000000i,1.88570308626040 + 0.00291146873441627i;4.22000000000000e-07 + 0.00000000000000i,1.88733389534255 + 0.00291503385645235i;4.23000000000000e-07 + 0.00000000000000i,1.88895779579138 + 0.00291865449196132i;4.24000000000000e-07 + 0.00000000000000i,1.89057212856013 + 0.00292227348807862i;4.25000000000000e-07 + 0.00000000000000i,1.89217602313890 + 0.00292591015968413i;4.26000000000000e-07 + 0.00000000000000i,1.89377477403415 + 0.00292958689660466i;4.27000000000000e-07 + 0.00000000000000i,1.89536737642820 + 0.00293333426857836i;4.28000000000000e-07 + 0.00000000000000i,1.89695328387655 + 0.00293714302487271i;4.29000000000000e-07 + 0.00000000000000i,1.89853230967903 + 0.00294099222497321i;4.30000000000000e-07 + 0.00000000000000i,1.90010302283373 + 0.00294486364943015i;4.31000000000000e-07 + 0.00000000000000i,1.90166585798777 + 0.00294873091946357i;4.32000000000000e-07 + 0.00000000000000i,1.90322256252146 + 0.00295268511570851i;4.33000000000000e-07 + 0.00000000000000i,1.90477306548988 + 0.00295669246154649i;4.34000000000000e-07 + 0.00000000000000i,1.90631549396783 + 0.00296070646532145i;4.35000000000000e-07 + 0.00000000000000i,1.90785065310469 + 0.00296475144651853i;4.36000000000000e-07 + 0.00000000000000i,1.90937895942898 + 0.00296883077506054i;4.37000000000000e-07 + 0.00000000000000i,1.91090013746037 + 0.00297294819066386i;4.38000000000000e-07 + 0.00000000000000i,1.91241739770793 + 0.00297716246412153i;4.39000000000000e-07 + 0.00000000000000i,1.91392684744481 + 0.00298139884562648i;4.40000000000000e-07 + 0.00000000000000i,1.91542851208374 + 0.00298562504145760i;4.41000000000000e-07 + 0.00000000000000i,1.91692310744097 + 0.00298989181282798i;4.42000000000000e-07 + 0.00000000000000i,1.91841280943076 + 0.00299423670291564i;4.43000000000000e-07 + 0.00000000000000i,1.91989687606518 + 0.00299862511420570i;4.44000000000000e-07 + 0.00000000000000i,1.92137095126479 + 0.00300298102006069i;4.45000000000000e-07 + 0.00000000000000i,1.92283765827807 + 0.00300738514938360i;4.46000000000000e-07 + 0.00000000000000i,1.92430198472194 + 0.00301187789069662i;4.47000000000000e-07 + 0.00000000000000i,1.92575988766946 + 0.00301639920966206i;4.48000000000000e-07 + 0.00000000000000i,1.92721066361647 + 0.00302093055955039i;4.49000000000000e-07 + 0.00000000000000i,1.92865594493773 + 0.00302551227908600i;4.50000000000000e-07 + 0.00000000000000i,1.93009530472343 + 0.00303013643364033i;4.51000000000000e-07 + 0.00000000000000i,1.93152815866547 + 0.00303478553803401i;4.52000000000000e-07 + 0.00000000000000i,1.93295589102729 + 0.00303949545435726i;4.53000000000000e-07 + 0.00000000000000i,1.93437651039790 + 0.00304420989697247i;4.54000000000000e-07 + 0.00000000000000i,1.93579210074748 + 0.00304898107624693i;4.55000000000000e-07 + 0.00000000000000i,1.93720071750210 + 0.00305376192254514i;4.56000000000000e-07 + 0.00000000000000i,1.93860475302172 + 0.00305860775465433i;4.57000000000000e-07 + 0.00000000000000i,1.94000319489491 + 0.00306348115717306i;4.58000000000000e-07 + 0.00000000000000i,1.94139484929760 + 0.00306839001376124i;4.59000000000000e-07 + 0.00000000000000i,1.94278140442244 + 0.00307331278270929i;4.60000000000000e-07 + 0.00000000000000i,1.94416303585299 + 0.00307830444315262i;4.61000000000000e-07 + 0.00000000000000i,1.94553890093637 + 0.00308332813202392i;4.62000000000000e-07 + 0.00000000000000i,1.94690975879909 + 0.00308838819385044i;4.63000000000000e-07 + 0.00000000000000i,1.94827432290403 + 0.00309346753846089i;4.64000000000000e-07 + 0.00000000000000i,1.94963259451732 + 0.00309857771052220i;4.65000000000000e-07 + 0.00000000000000i,1.95098304187808 + 0.00310369881783684i;4.66000000000000e-07 + 0.00000000000000i,1.95233303206694 + 0.00310891515838342i;4.67000000000000e-07 + 0.00000000000000i,1.95367468872835 + 0.00311410349091203i;4.68000000000000e-07 + 0.00000000000000i,1.95501392311016 + 0.00311937960962705i;4.69000000000000e-07 + 0.00000000000000i,1.95634806622595 + 0.00312470717501437i;4.70000000000000e-07 + 0.00000000000000i,1.95767472676877 + 0.00313000337212308i;4.71000000000000e-07 + 0.00000000000000i,1.95899830975024 + 0.00313538167488432i;4.72000000000000e-07 + 0.00000000000000i,1.96031536965871 + 0.00314076996962905i;4.73000000000000e-07 + 0.00000000000000i,1.96162825649185 + 0.00314620632616782i;4.74000000000000e-07 + 0.00000000000000i,1.96293647114195 + 0.00315169241900064i;4.75000000000000e-07 + 0.00000000000000i,1.96423944472408 + 0.00315720218556396i;4.76000000000000e-07 + 0.00000000000000i,1.96553774473859 + 0.00316274694288061i;4.77000000000000e-07 + 0.00000000000000i,1.96682953715526 + 0.00316828334110147i;4.78000000000000e-07 + 0.00000000000000i,1.96811798035693 + 0.00317388130239473i;4.79000000000000e-07 + 0.00000000000000i,1.96940237780368 + 0.00317954761802611i;4.80000000000000e-07 + 0.00000000000000i,1.97068129075908 + 0.00318521474296255i;4.81000000000000e-07 + 0.00000000000000i,1.97195539578988 + 0.00319091863399960i;4.82000000000000e-07 + 0.00000000000000i,1.97322486008327 + 0.00319664983071164i;4.83000000000000e-07 + 0.00000000000000i,1.97448881736653 + 0.00320242015721987i;4.84000000000000e-07 + 0.00000000000000i,1.97575074669963 + 0.00320825324469880i;4.85000000000000e-07 + 0.00000000000000i,1.97700208053624 + 0.00321404480638167i;4.86000000000000e-07 + 0.00000000000000i,1.97825409280116 + 0.00321994081235327i;4.87000000000000e-07 + 0.00000000000000i,1.97950049012082 + 0.00322582860249062i;4.88000000000000e-07 + 0.00000000000000i,1.98074437463110 + 0.00323178069183873i;4.89000000000000e-07 + 0.00000000000000i,1.98198167427406 + 0.00323774782006109i;4.90000000000000e-07 + 0.00000000000000i,1.98321641048442 + 0.00324377400192191i;4.91000000000000e-07 + 0.00000000000000i,1.98444476381484 + 0.00324979571482151i;4.92000000000000e-07 + 0.00000000000000i,1.98567045521799 + 0.00325587751166869i;4.93000000000000e-07 + 0.00000000000000i,1.98689069688859 + 0.00326197338614579i;4.94000000000000e-07 + 0.00000000000000i,1.98810648517464 + 0.00326808879773694i;4.96000000000000e-07 + 0.00000000000000i,1.99052812301391 + 0.00328048548602835i;4.97000000000000e-07 + 0.00000000000000i,1.99173185902690 + 0.00328671463649693i;4.98000000000000e-07 + 0.00000000000000i,1.99293210978239 + 0.00329296803342736i;4.99000000000000e-07 + 0.00000000000000i,1.99412829045436 + 0.00329926412194369i;5.00000000000000e-07 + 0.00000000000000i,1.99532085563723 + 0.00330561034832676i];
d = Data(:,1);neff = (Data(:,2));perm = neff.^2;

figure;
yyaxis right;
plot(d*1e9,abs(real(perm)));
set(gcf, 'Position', [00, 00, 400, 300]);
ylabel('Real permittivity');
xlabel('Waveguide width');
yyaxis left;
hold on;
plot(d*1e9,imag(perm));
ylabel('Imaginary permittivity');
xlabel('Waveguide width');
legend(["Imaginary permittivity","Real permittivity"]);
title('PECVD 50nm SiN');
xlim([150 400])

k0 = 2*pi/1550e-5;
L = 20e-6;
M = 300;
ne = 1.8;
z = -L/2:(L/(M - 1)):L/2;
wz = 2*ne*z/L;
permz = wz.^2;
figure;
plot(z,permz);

for ind = 1:1:M
    [~,inx] = min(abs((real(permz(ind) - perm)))); 
    d_Al(ind) = d(inx); 
    eps(ind) = perm(inx); 
end

figure;
yyaxis left;
plot(z*1e6,real(eps));
set(gcf, 'Position', [00, 00, 400, 300]);
xlabel('x(\mum)');
ylabel('Re[\epsilon]');
yyaxis right
plot(z*1e6,imag(eps));
set(gcf, 'Position', [00, 00, 400, 300]);
xlabel('x(\mum)');
ylabel('Im[\epsilon]');

figure;
plot(z*1e6,d_Al*1e9);
set(gcf, 'Position', [00, 00, 400, 300]);
xlabel('x(\mum)');
ylabel('Waveguide width(nm)')

figure;
plot(z,imag(eps))

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%For Comsol Geometry
% a = 0.181/0.161 - 1;
a = 0.161/0.161 - 1;
gc = -a*(abs(2*z/L)).^2 + a + 1;
Al_Y = [d_Al.*gc*1e6 -d_Al.*gc*1e6]/2;
Al_Y_h = Al_Y';
Al_Z = [z -z]*1e6;
Al_Z_h = Al_Z';
% Al_Y = [d_Al-0.0e-6 -d_Al+0.0e-6]/2*1e6;Al_Z = [z -z]*1e6;
% PumpSweep = unique(Lx_Al_Com)*1e9;
SiO_Y = [d_Al + 100e-9 -d_Al - 100e-9]/2*1e6;
SiO_Z = [z -z];


% % %%%%3.3^2 +(0.03*exp(-((z-5.168[um])/2[um])^2) + 0.03*exp(-((z+5.168[um])/2[um])^2) + 0.017*exp(-(z/10[um])^2))*i
% % tm = 0.03*exp(-((z-5.168e-6)/2e-6).^2) + 0.03*exp(-((z+5.168e-6)/2e-6).^2) + 0.017*exp(-(z/10e-6).^2);
% % figure
% % plot(z,tm)