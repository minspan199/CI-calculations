clc
clear all
close all

Data = [9.40000000000000e-08 + 0.00000000000000i,0.0147896611237521 + 0.345696280075816i,-0.119287183982102 + 0.0102254616681260i;9.60000000000000e-08 + 0.00000000000000i,0.0351287451553502 + 0.141634592385400i,-0.0188263290239888 + 0.00995089100217722i;9.80000000000000e-08 + 0.00000000000000i,0.280645731187176 + 0.0172392858523318i,0.0784648334568863 + 0.00967626396634477i;1.00000000000000e-07 + 0.00000000000000i,0.415790753706737 + 0.0113012958071605i,0.172754231581096 + 0.00939794860304413i;1.02000000000000e-07 + 0.00000000000000i,0.514067487767544 + 0.00886161618418855i,0.264186853738238 + 0.00911093753873202i;1.04000000000000e-07 + 0.00000000000000i,0.594117688033250 + 0.00741436768874625i,0.352920854385751 + 0.00881001397893272i;1.06000000000000e-07 + 0.00000000000000i,0.662677258327105 + 0.00640527723256044i,0.439100121127503 + 0.00848926311059637i;1.08000000000000e-07 + 0.00000000000000i,0.723120961311572 + 0.00563178351799577i,0.522872207702579 + 0.00814492142286354i;1.10000000000000e-07 + 0.00000000000000i,0.777437934899430 + 0.00500406774686291i,0.604384701926675 + 0.00778070419043588i;1.12000000000000e-07 + 0.00000000000000i,0.826929572241155 + 0.00448584300227662i,0.683792394659498 + 0.00741895247002716i;1.14000000000000e-07 + 0.00000000000000i,0.872498463332565 + 0.00407464722950769i,0.761236965767642 + 0.00711024689273551i;1.16000000000000e-07 + 0.00000000000000i,0.914785839470528 + 0.00378314381201277i,0.836818819918695 + 0.00692153277581967i;1.18000000000000e-07 + 0.00000000000000i,0.954261789611365 + 0.00361064360185842i,0.910602526365065 + 0.00689099845031648i;1.20000000000000e-07 + 0.00000000000000i,0.991301294251345 + 0.00352866940748176i,0.982665804476605 + 0.00699594910124360i;1.22000000000000e-07 + 0.00000000000000i,1.02625054793938 + 0.00350175766065659i,1.05317792483917 + 0.00718736143599950i;1.24000000000000e-07 + 0.00000000000000i,1.05944750774924 + 0.00351377774373049i,1.12241667504205 + 0.00744532614676004i;1.26000000000000e-07 + 0.00000000000000i,1.09125772055404 + 0.00357860706173150i,1.19083060624029 + 0.00781036516988740i;1.28000000000000e-07 + 0.00000000000000i,1.12212659085056 + 0.00374956995049896i,1.25915402661908 + 0.00841498429141817i;1.30000000000000e-07 + 0.00000000000000i,1.15271557914938 + 0.00414485555707732i,1.32873602658610 + 0.00955567914793382i;1.32000000000000e-07 + 0.00000000000000i,1.18411185888665 + 0.00495413757146160i,1.40209635087692 + 0.0117325060978472i;1.34000000000000e-07 + 0.00000000000000i,1.21765990522450 + 0.00618818963049038i,1.48265735110043 + 0.0150702207979483i;1.36000000000000e-07 + 0.00000000000000i,1.25361031684127 + 0.00734784946617244i,1.57148483559909 + 0.0184226797947808i;1.38000000000000e-07 + 0.00000000000000i,1.29058889944891 + 0.00809284910637341i,1.66555421317409 + 0.0208890824432011i;1.40000000000000e-07 + 0.00000000000000i,1.32726145912584 + 0.00852419521419312i,1.76155031897680 + 0.0226276715557269i;1.42000000000000e-07 + 0.00000000000000i,1.36296620897228 + 0.00878735819088945i,1.85759966913630 + 0.0239537445606362i;1.44000000000000e-07 + 0.00000000000000i,1.39744458157612 + 0.00896262117204832i,1.95277102999818 + 0.0250495327871967i;1.46000000000000e-07 + 0.00000000000000i,1.43066672012522 + 0.00908956636908596i,2.04672464385708 + 0.0260082802092414i;1.48000000000000e-07 + 0.00000000000000i,1.46262844725376 + 0.00918744649115257i,2.13919756554291 + 0.0268756411911629i;1.50000000000000e-07 + 0.00000000000000i,1.49338202411122 + 0.00926659540226276i,2.23010400014818 + 0.0276771339969018i;1.52000000000000e-07 + 0.00000000000000i,1.52298740190101 + 0.00933295883973512i,2.31940352222848 + 0.0284279574707545i;1.54000000000000e-07 + 0.00000000000000i,1.55150516859766 + 0.00938992586305770i,2.40708011747755 + 0.0291370370185658i;1.56000000000000e-07 + 0.00000000000000i,1.57900026209688 + 0.00943992339799200i,2.49315271554825 + 0.0298112830392077i;1.58000000000000e-07 + 0.00000000000000i,1.60552890223125 + 0.00948438618667711i,2.57763310231854 + 0.0304549122852659i;1.60000000000000e-07 + 0.00000000000000i,1.63114491908332 + 0.00952427255390402i,2.66054303528365 + 0.0310709375685305i;1.62000000000000e-07 + 0.00000000000000i,1.65589853357430 + 0.00956040992547850i,2.74190855205556 + 0.0316621375519380i;1.64000000000000e-07 + 0.00000000000000i,1.67983314061051 + 0.00959346354263158i,2.82174734575062 + 0.0322308359843024i;1.66000000000000e-07 + 0.00000000000000i,1.70300463462788 + 0.00962368096723462i,2.90013217032869 + 0.0327783465787614i;1.68000000000000e-07 + 0.00000000000000i,1.72544377008894 + 0.00965152549601276i,2.97706305179432 + 0.0333063290778995i;1.70000000000000e-07 + 0.00000000000000i,1.74719095751082 + 0.00967727155512773i,3.05258259242282 + 0.0338160827089917i;1.72000000000000e-07 + 0.00000000000000i,1.76827940012081 + 0.00970112479053009i,3.12671792506939 + 0.0343085982501912i;1.74000000000000e-07 + 0.00000000000000i,1.78874056677701 + 0.00972325587048062i,3.19949827352901 + 0.0347847644333627i;1.76000000000000e-07 + 0.00000000000000i,1.80860577994673 + 0.00974385613590318i,3.27095992452431 + 0.0352455890527277i;1.78000000000000e-07 + 0.00000000000000i,1.82790189897943 + 0.00976308755153440i,3.34113003441405 + 0.0356919325507042i;1.80000000000000e-07 + 0.00000000000000i,1.84665559261365 + 0.00978104345473340i,3.41004120892022 + 0.0361244371945612i;1.82000000000000e-07 + 0.00000000000000i,1.86488925503149 + 0.00979781599922404i,3.47771593633356 + 0.0365436835594571i;1.84000000000000e-07 + 0.00000000000000i,1.88262739266517 + 0.00981348873326661i,3.54418959505213 + 0.0369502854137174i;1.86000000000000e-07 + 0.00000000000000i,1.89988567655085 + 0.00982823942606043i,3.60946898967285 + 0.0373450626225690i;1.88000000000000e-07 + 0.00000000000000i,1.91669223173662 + 0.00984201287759377i,3.67361224598203 + 0.0377282192542716i;1.90000000000000e-07 + 0.00000000000000i,1.93306272090061 + 0.00985493561894303i,3.73663436317960 + 0.0381004173237086i;1.92000000000000e-07 + 0.00000000000000i,1.94901469164693 + 0.00986707811895833i,3.79856090902499 + 0.0384621604349556i;1.94000000000000e-07 + 0.00000000000000i,1.96456277897370 + 0.00987843983645999i,3.85940932895525 + 0.0388136304340806i;1.96000000000000e-07 + 0.00000000000000i,1.97972514635972 + 0.00988914276851537i,3.91921385998432 + 0.0391555692295425i;1.98000000000000e-07 + 0.00000000000000i,1.99451409509580 + 0.00989918125167354i,3.97798848174636 + 0.0394881130727419i;2.00000000000000e-07 + 0.00000000000000i,2.00894535921756 + 0.00990859842162312i,4.03576327599911 + 0.0398116656309405i;2.02000000000000e-07 + 0.00000000000000i,2.02303096179123 + 0.00991744231341107i,4.09255591670390 + 0.0401265857236180i;2.04000000000000e-07 + 0.00000000000000i,2.03678102706770 + 0.00992578969275703i,4.14837843092193 + 0.0404333202497433i;2.06000000000000e-07 + 0.00000000000000i,2.05021276240668 + 0.00993354106140810i,4.20327369589721 + 0.0407317453199794i;2.08000000000000e-07 + 0.00000000000000i,2.06333576433827 + 0.00994087242209857i,4.25725565545287 + 0.0410227151944800i;2.10000000000000e-07 + 0.00000000000000i,2.07615932069776 + 0.00994774130254232i,4.31033856736316 + 0.0413061916503266i;2.12000000000000e-07 + 0.00000000000000i,2.08869357096016 + 0.00995415713245360i,4.36254174812610 + 0.0415823680137662i;2.14000000000000e-07 + 0.00000000000000i,2.10094976388423 + 0.00996019163915802i,4.41389070494772 + 0.0418517245450615i;2.16000000000000e-07 + 0.00000000000000i,2.11293533972967 + 0.00996583613712335i,4.46439643198860 + 0.0421143347281658i;2.18000000000000e-07 + 0.00000000000000i,2.12465975624145 + 0.00997111556388900i,4.51407965664639 + 0.0423704559268555i;2.20000000000000e-07 + 0.00000000000000i,2.13613245666431 + 0.00997606435784054i,4.56296235055464 + 0.0426203897291104i;2.22000000000000e-07 + 0.00000000000000i,2.14735987714640 + 0.00998068867857774i,4.61105482783170 + 0.0428642608293343i;2.24000000000000e-07 + 0.00000000000000i,2.15835002192164 + 0.00998498509820765i,4.65837511720175 + 0.0431021856112075i;2.26000000000000e-07 + 0.00000000000000i,2.16910853347089 + 0.00998901380441924i,4.70493204957945 + 0.0433345101682486i;2.28000000000000e-07 + 0.00000000000000i,2.17964667151747 + 0.00999273038479703i,4.75075975799663 + 0.0435612430451886i;2.30000000000000e-07 + 0.00000000000000i,2.18996903595899 + 0.00999620894012610i,4.79586445426597 + 0.0437827761117052i;2.32000000000000e-07 + 0.00000000000000i,2.20008145727161 + 0.00999940283069919i,4.84025843057338 + 0.0439990015032210i;2.34000000000000e-07 + 0.00000000000000i,2.20999097829313 + 0.0100023787607770i,4.88396007655615 + 0.0442103336455758i;2.36000000000000e-07 + 0.00000000000000i,2.21970288436616 + 0.0100051190839146i,4.92698079245556 + 0.0444167833779844i;2.38000000000000e-07 + 0.00000000000000i,2.22922299814746 + 0.0100076419173434i,4.96933502257280 + 0.0446185310387328i;2.40000000000000e-07 + 0.00000000000000i,2.23855734829671 + 0.0100099579474559i,5.01103880235507 + 0.0448157298388366i;2.42000000000000e-07 + 0.00000000000000i,2.24771042629129 + 0.0100120828680031i,5.05210191865522 + 0.0450085261026061i;2.44000000000000e-07 + 0.00000000000000i,2.25668618103546 + 0.0100140225287625i,5.09253223902922 + 0.0451970125144721i;2.46000000000000e-07 + 0.00000000000000i,2.26549215972194 + 0.0100157654824625i,5.13235441020339 + 0.0453812763482649i;2.48000000000000e-07 + 0.00000000000000i,2.27413205261311 + 0.0100173420923540i,5.17157624557971 + 0.0455615174684255i;2.50000000000000e-07 + 0.00000000000000i,2.28261018588957 + 0.0100187700642145i,5.21020888497322 + 0.0457378931973228i;2.52000000000000e-07 + 0.00000000000000i,2.29093002655459 + 0.0100200148892922i,5.24825998587104 + 0.0459103059528071i;2.54000000000000e-07 + 0.00000000000000i,2.29909728816659 + 0.0100211307861918i,5.28574791739273 + 0.0460791092297926i;2.56000000000000e-07 + 0.00000000000000i,2.30711510434319 + 0.0100221018595899i,5.32267966216280 + 0.0462442851550515i;2.58000000000000e-07 + 0.00000000000000i,2.31498724438342 + 0.0100229424320107i,5.35906548228295 + 0.0464059677625883i;2.60000000000000e-07 + 0.00000000000000i,2.32271739182535 + 0.0100236233316599i,5.39491560926326 + 0.0465640884831056i;2.62000000000000e-07 + 0.00000000000000i,2.33031011878773 + 0.0100242131154944i,5.43024476487591 + 0.0467190505118428i;2.64000000000000e-07 + 0.00000000000000i,2.33776786436256 + 0.0100246707883242i,5.46505809362187 + 0.0468707064395167i;2.66000000000000e-07 + 0.00000000000000i,2.34509366814796 + 0.0100250310866508i,5.49936381113935 + 0.0470192738485825i;2.68000000000000e-07 + 0.00000000000000i,2.35229244991766 + 0.0100252750508077i,5.53317926379979 + 0.0471647576207259i;2.70000000000000e-07 + 0.00000000000000i,2.35936642819535 + 0.0100254076066926i,5.56650943369760 + 0.0473072202724096i;2.72000000000000e-07 + 0.00000000000000i,2.36631869876293 + 0.0100254419534225i,5.59936367462873 + 0.0474467815154922i;2.74000000000000e-07 + 0.00000000000000i,2.37315221808838 + 0.0100253844599604i,5.63175094188422 + 0.0475835267366877i;2.76000000000000e-07 + 0.00000000000000i,2.37986969334274 + 0.0100252379894691i,5.66367925189454 + 0.0477175201193719i;2.78000000000000e-07 + 0.00000000000000i,2.38647386073775 + 0.0100249937305249i,5.69515698748524 + 0.0478487709839151i;2.80000000000000e-07 + 0.00000000000000i,2.39296798576751 + 0.0100246832740335i,5.72619528663347 + 0.0479774922844422i;2.82000000000000e-07 + 0.00000000000000i,2.39935406708338 + 0.0100242925149028i,5.75679945278915 + 0.0481036540305311i;2.84000000000000e-07 + 0.00000000000000i,2.40563390700899 + 0.0100238282271538i,5.78697401741899 + 0.0482273221225499i;2.86000000000000e-07 + 0.00000000000000i,2.41181169157736 + 0.0100232866838941i,5.81673516935329 + 0.0483485600244946i;2.88000000000000e-07 + 0.00000000000000i,2.41788899910007 + 0.0100226798427297i,5.84608675785791 + 0.0484674546664762i;2.90000000000000e-07 + 0.00000000000000i,2.42386797852617 + 0.0100220067542390i,5.87503553670518 + 0.0485840425043457i;2.92000000000000e-07 + 0.00000000000000i,2.42975082535559 + 0.0100212672165601i,5.90358864751953 + 0.0486983645810913i;2.94000000000000e-07 + 0.00000000000000i,2.43553979352348 + 0.0100204663725698i,5.93175367609005 + 0.0488104892001151i;2.96000000000000e-07 + 0.00000000000000i,2.44123686373240 + 0.0100196097275306i,5.95953703226691 + 0.0489204812541186i;2.98000000000000e-07 + 0.00000000000000i,2.44684428382817 + 0.0100186993121370i,5.98694657496670 + 0.0490283942865912i;3.00000000000000e-07 + 0.00000000000000i,2.45236403793469 + 0.0100177392847481i,6.01398901945494 + 0.0491342871266436i;3.02000000000000e-07 + 0.00000000000000i,2.45779748970237 + 0.0100167259525060i,6.04066816558848 + 0.0492381678022115i;3.04000000000000e-07 + 0.00000000000000i,2.46314701244595 + 0.0100156628634610i,6.06699289141879 + 0.0493401001195995i;3.06000000000000e-07 + 0.00000000000000i,2.46841357154156 + 0.0100145622341427i,6.09296526871383 + 0.0494401626636107i;3.08000000000000e-07 + 0.00000000000000i,2.47360072966947 + 0.0100134221907816i,6.11860030119734 + 0.0495384168752118i;3.10000000000000e-07 + 0.00000000000000i,2.47870890884051 + 0.0100122324571330i,6.14389760996654 + 0.0496348195777555i;3.12000000000000e-07 + 0.00000000000000i,2.48373987290864 + 0.0100110011882484i,6.16886353613143 + 0.0497294456379766i;3.14000000000000e-07 + 0.00000000000000i,2.48869549030904 + 0.0100097398193779i,6.19350504859331 + 0.0498223886953051i;3.16000000000000e-07 + 0.00000000000000i,2.49357697458235 + 0.0100084360852102i,6.21782595937441 + 0.0499136115473185i;3.18000000000000e-07 + 0.00000000000000i,2.49838613545341 + 0.0100070992686015i,6.24183313979005 + 0.0500031961375600i;3.20000000000000e-07 + 0.00000000000000i,2.50312451902935 + 0.0100057321669278i,6.26553224308971 + 0.0500911870357552i;3.22000000000000e-07 + 0.00000000000000i,2.50779322140366 + 0.0100043331138461i,6.28892675463709 + 0.0501775975351351i;3.24000000000000e-07 + 0.00000000000000i,2.51239404699157 + 0.0100029038192492i,6.31202378927385 + 0.0502624720162216i;3.26000000000000e-07 + 0.00000000000000i,2.51692745435412 + 0.0100014591534352i,6.33482378129629 + 0.0503458942537647i;3.28000000000000e-07 + 0.00000000000000i,2.52139613067461 + 0.00999997585927561i,6.35733844826371 + 0.0504278008768341i;3.30000000000000e-07 + 0.00000000000000i,2.52580071344593 + 0.00999846882934668i,6.37956927466503 + 0.0505082794050614i;3.32000000000000e-07 + 0.00000000000000i,2.53014240286248 + 0.00999693447432824i,6.40152064006382 + 0.0505873356242711i;3.34000000000000e-07 + 0.00000000000000i,2.53442240604412 + 0.00999537727069030i,6.42319702469166 + 0.0506650162234031i;3.36000000000000e-07 + 0.00000000000000i,2.53864241193707 + 0.00999380603308340i,6.44460541952666 + 0.0507413997045162i;3.38000000000000e-07 + 0.00000000000000i,2.54280321051878 + 0.00999221512076682i,6.46574832306157 + 0.0508164733785602i;3.40000000000000e-07 + 0.00000000000000i,2.54690579620245 + 0.00999059521344599i,6.48662932273690 + 0.0508902097132760i;3.42000000000000e-07 + 0.00000000000000i,2.55095136737171 + 0.00998896278224092i,6.50725309931812 + 0.0509627165359651i;3.44000000000000e-07 + 0.00000000000000i,2.55494110351827 + 0.00998730998145934i,6.52762429608650 + 0.0510339775704175i;3.46000000000000e-07 + 0.00000000000000i,2.55887573412564 + 0.00998565192828506i,6.54774530945260 + 0.0511040848174271i;3.48000000000000e-07 + 0.00000000000000i,2.56275706391390 + 0.00998396843377215i,6.56762408901489 + 0.0511729712590859i;3.50000000000000e-07 + 0.00000000000000i,2.56658551330617 + 0.00998227280859340i,6.58726155134269 + 0.0512407135608119i;3.52000000000000e-07 + 0.00000000000000i,2.57036234936931 + 0.00998056687465783i,6.60666299534018 + 0.0513073466399660i;3.54000000000000e-07 + 0.00000000000000i,2.57408818090899 + 0.00997884113391741i,6.62583038582495 + 0.0513728340439705i;3.56000000000000e-07 + 0.00000000000000i,2.57776424428896 + 0.00997710967801876i,6.64476895641712 + 0.0514372731786923i;3.58000000000000e-07 + 0.00000000000000i,2.58139125445101 + 0.00997536194154314i,6.66348130071029 + 0.0515006241517658i;3.60000000000000e-07 + 0.00000000000000i,2.58497025193549 + 0.00997360642609780i,6.68197173056629 + 0.0515629518319509i;3.62000000000000e-07 + 0.00000000000000i,2.58850224023230 + 0.00997184645679782i,6.70024440996588 + 0.0516242937853474i;3.64000000000000e-07 + 0.00000000000000i,2.59198759265135 + 0.00997006812559938i,6.71830027820011 + 0.0516845857588846i;3.66000000000000e-07 + 0.00000000000000i,2.59542706743156 + 0.00996828750847415i,6.73614229560053 + 0.0517439264308674i;3.68000000000000e-07 + 0.00000000000000i,2.59882238985245 + 0.00996649870813069i,6.75377848290191 + 0.0518023199822512i;3.70000000000000e-07 + 0.00000000000000i,2.60217385230787 + 0.00996470521009576i,6.77120946228484 + 0.0518597906873343i;3.72000000000000e-07 + 0.00000000000000i,2.60548217901950 + 0.00996290349065285i,6.78843812574224 + 0.0519163349923743i;3.74000000000000e-07 + 0.00000000000000i,2.60874796385044 + 0.00996109093704247i,6.80546671556115 + 0.0519719513994772i;3.76000000000000e-07 + 0.00000000000000i,2.61197220662737 + 0.00995927766904443i,6.82229962098216 + 0.0520267129392573i;3.78000000000000e-07 + 0.00000000000000i,2.61515554544297 + 0.00995745784465592i,6.83893937589436 + 0.0520806022019330i;3.80000000000000e-07 + 0.00000000000000i,2.61829877527682 + 0.00995563692130569i,6.85538936190960 + 0.0521336639163108i;3.82000000000000e-07 + 0.00000000000000i,2.62140230744437 + 0.00995380863876885i,6.87165097916826 + 0.0521858738670568i;3.84000000000000e-07 + 0.00000000000000i,2.62446723434300 + 0.00995197751138345i,6.88772922228360 + 0.0522372777910885i;3.86000000000000e-07 + 0.00000000000000i,2.62749354688441 + 0.00995014985406101i,6.90362333343712 + 0.0522879090641564i;3.88000000000000e-07 + 0.00000000000000i,2.63048257919647 + 0.00994831266404412i,6.91933963053125 + 0.0523377263103354i;3.90000000000000e-07 + 0.00000000000000i,2.63343479633847 + 0.00994647364081102i,6.93487989422836 + 0.0523867795731503i;3.92000000000000e-07 + 0.00000000000000i,2.63635077382688 + 0.00994463383583475i,6.95024650691543 + 0.0524350862170557i;3.94000000000000e-07 + 0.00000000000000i,2.63923106613580 + 0.00994279354712249i,6.96544176131281 + 0.0524826592274805i;3.96000000000000e-07 + 0.00000000000000i,2.64207636188873 + 0.00994095369047358i,6.98046867949092 + 0.0525295175204616i;3.98000000000000e-07 + 0.00000000000000i,2.64488700949105 + 0.00993910696698455i,6.99532850712720 + 0.0525756298058388i;4.00000000000000e-07 + 0.00000000000000i,2.64766392807914 + 0.00993726656791846i,7.01002552678460 + 0.0526210844711690i];
d = Data(:,1);neff = (Data(:,2));perm = neff.^2;

figure;plot(d*1e9,real(perm));
figure;plot(d*1e9,imag(perm))

figure;
yyaxis right;
plot(d*1e9,abs(real(neff)));
set(gcf, 'Position', [00, 00, 400, 300]);
ylabel('Real index');
xlabel('Waveguide width');
yyaxis left;
hold on;
plot(d*1e9,imag(neff));
ylabel('Imaginary index');
xlabel('Waveguide width');
legend(["Imaginary Index","Real Index"])

k0 = 2*pi/1550e-5;
L = 20e-6;
M = 300;
ne = 2.7;
z = -L/2:(L/(M - 1)):L/2;
wz = 2*ne*z/L;
permz = wz.^2;
figure;
plot(z,permz);

for ind = 1:1:M
    [~,inx] = min(abs((real(permz(ind) - perm)))); 
    d_Al(ind) = d(inx); 
    eps(ind) = perm(inx); 
end

figure;yyaxis left;
plot(z*1e6,real(eps));set(gcf, 'Position', [00, 00, 400, 300]);xlabel('x(\mum)');ylabel('Re[\epsilon]');yyaxis right
plot(z*1e6,imag(eps));set(gcf, 'Position', [00, 00, 400, 300]);xlabel('x(\mum)');ylabel('Im[\epsilon]');

figure;
plot(z*1e6,d_Al*1e9);
set(gcf, 'Position', [00, 00, 400, 300]);
xlabel('x(\mum)');
ylabel('Waveguide width(nm)')

figure;
plot(z,imag(eps))

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%For Comsol Geometry
% a = 0.181/0.161 - 1;
a = 0.161/0.161 - 1;
gc = -a*(abs(2*z/L)).^2 + a + 1;
Al_Y = [d_Al.*gc*1e6 -d_Al.*gc*1e6]/2;
Al_Y_h = Al_Y';
Al_Z = [z -z]*1e6;
Al_Z_h = Al_Z';
% Al_Y = [d_Al-0.0e-6 -d_Al+0.0e-6]/2*1e6;Al_Z = [z -z]*1e6;
% PumpSweep = unique(Lx_Al_Com)*1e9;
SiO_Y = [d_Al + 140e-9 -d_Al - 140e-9]/2*1e6;
SiO_Z = [z -z];


% % %%%%3.3^2 +(0.03*exp(-((z-5.168[um])/2[um])^2) + 0.03*exp(-((z+5.168[um])/2[um])^2) + 0.017*exp(-(z/10[um])^2))*i
% % tm = 0.03*exp(-((z-5.168e-6)/2e-6).^2) + 0.03*exp(-((z+5.168e-6)/2e-6).^2) + 0.017*exp(-(z/10e-6).^2);
% % figure
% % plot(z,tm)